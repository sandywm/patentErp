<!DOCTYPE html>
<html> 
<head>
 	<meta charset="utf-8"/>
 	<link href="/plugins/layui/css/layui.css" rel="stylesheet" type="text/css"/>
 	<link href="/plugins/pace/pace-theme-flash.min.css" rel="stylesheet" type="text/css"/>
 	<link href="/Module/zlBasicInfoManager/css/zlBasicInfoManager.css" rel="stylesheet" type="text/css"/>
	<script src="/plugins/pace/pace.min.js" type="text/javascript"></script>
  	<title>增加新专利</title>
</head>
<body style="background:#fff;margin-top:50px;">
	<div class="layui-card-header headerWrap">
		<span id="titSpan"></span>
		<a class="closeBtns" href="javascript:void(0)"><i class="layui-icon layui-icon-close"></i></a>
	</div>
	<div id="addNewZl" class="layui-form">
		<div class="layui-form-item">
			<label class="layui-form-label"><span class="mustItem">*</span>案件类型</label>
			<div class="layui-input-block">
				<input type="hidden" id="anjianType"/>
				<input type="radio" name="ajTypeRad" class="ajTypeRad" lay-filter="ajTypeRadFilter" value="new" title="新案"/>
				<input type="radio" name="ajTypeRad" class="ajTypeRad" lay-filter="ajTypeRadFilter" value="old" title="旧案(中途转入)"/>
			</div>				
		</div>
		<div id="zlTitleBox" class="layui-form-item">
			<div class="originZlTitBox">
				<label class="layui-form-label"><span class="mustItem">*</span>案件标题</label>
				<div class="layui-input-block">
					<input id="ajTitleInp" type="text" name="ajTitle" placeholder="请输入案件标题(40字以内)" maxlength="40" autocomplete="off" class="layui-input"/>
				</div>			
			</div>
		</div>
		<div class="layui-form-item">
			<div class="itemDiv">
				<label class="layui-form-label"><span class="mustItem">*</span>专利类型</label>
				<input id="zlTypeInp" name="ajType" type="hidden" value=""/>
				<div class="layui-input-inline">
					<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="fm" title="发明"/>
					<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="syxx" title="实用新型"/>
					<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="wg" title="外观"/>
					<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="fmxx" title="发明+新型"/>
				</div>	
			</div>	
			<div class="itemDiv feeDiv">
				<label class="layui-form-label titLabel"><span class="mustItem">*</span>是否费减</label>
				<input id="rateInp" type="hidden"/>
				<div class="layui-input-inline">
					<input type="radio" name="feeRateInp" value="0" lay-filter="isHasFeeRateFilter" title="无费减">
					<input type="radio" name="feeRateInp" lay-filter="isHasFeeRateFilter" value="0.7" title="70%">
					<input type="radio" name="feeRateInp" lay-filter="isHasFeeRateFilter" value="0.85" title="85%">
				</div>
			</div>
		</div>
		<div class="layui-form-item clearfix">
			<div class="itemDiv">
				<label class="layui-form-label">案件编号</label>
				<div class="layui-input-inline">
					<input id="ajNumInp" type="text" disabled autocomplete="off" class="layui-input"/>
				</div>	
			</div>			
			<div id="zlNumBoxWrap" class="itemDiv">
				<div class="originZlNumBox">
					<label class="layui-form-label"><span class="mustItem zlNoMustBe"></span>案件申请号/专利号</label>
					<div class="layui-input-inline" style="width:69.2%;">
						<p class="zlPatternNum singWid"></p>
						<input id="ajSqZlNum" type="text" name="ajSqZlNum" disabled maxlength="20" autocomplete="off" class="layui-input"/>
					</div>	
				</div>
			</div>			
		</div>
		<div class="layui-form-item clearfix">
			<div class="itemDiv">
				<label class="layui-form-label">已领取专利任务</label>
				<div class="layui-input-block">
					<input id="pubZlIdInp" type="hidden" name="pubZlId"/>					
					<input id="pubZlIdInpTxt" type="text" disabled autocomplete="off" class="layui-input" style="width:94%"/>
					<span class="selZlTaskSp" title="选择"><i class="layui-icon layui-icon-more"></i></span>
					<span class="resetSp" title="重置"><i class="layui-icon layui-icon-delete"></i></span>
				</div>	
			</div>			
		</div>
		<div class="layui-form-item">
			<div class="agentFeeDiv">
				<label class="layui-form-label"><span class="mustItem">*</span>专利代理费</label>
				<div class="layui-input-block">
					<span class="tipsInfo">请先选择专利类型</span>
					<div class="agentBox">
						<div class="initDlFeeBox fl">
							<p class="getTypeTxt fl">提醒方式</p>
							<div class="getDlFeeType fl">
								<input type="hidden" id="remindInp"/>
								<input type="radio" name="remindInpRad" lay-filter="remindInpFilter" value="0" title="时间提醒"/>
								<input type="radio" name="remindInpRad" lay-filter="remindInpFilter" value="1" title="事务提醒"/>
							</div>
							<p class="initFeeTxt fl"><i class="layui-icon layui-icon-tips"></i><span class="singleDlFee"></span><span class="secInitDlFee"></span></p>
						</div>
						<div class="addDlFeeBox fmxxDlFee fl">
							<div id="dlFeeListWrap"></div>
							<span id="addDlFeeBtn" class="addSpan fl">添加代理费</span>
						</div>
						<div class="addDlFeeBox fmxxDlFee fmxxDlFee_xx fl">
							<div id="dlFeeListWrap_xx"></div>
							<span id="addDlFeeBtn_xx" class="addSpan fl">添加新型专利代理费</span>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"><span class="mustItem">*</span>案件技术领域</label>
			<div class="layui-input-block fixHeiDiv clearfix">
				<input id="ajFieldId" type="hidden" name="ajFieldId"/>
				<div id="fieldBox" class="multiBox fl"></div>
				<span id="addFieldBtn" class="addSpan fl">添加技术领域</span>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"><span class="mustItem">*</span>案件申请地区</label>
			<input id="ajSqAddress" type="hidden" name="ajSqAddress"/>
			<div class="layui-input-block fixHeiDiv clearfix">
				<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国" title="中国[CN]"/>
				<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国香港" title="中国香港[HK]"/>
				<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国台湾" title="中国台湾[TW]"/>
				<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="澳门" title="澳门[MO]"/>
				<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="日本" title="日本[JP]"/>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"><span class="mustItem">*</span>申请人</label>
			<input id="sqrIdInp" type="hidden"/>
			<div class="layui-input-block fixHeiDiv clearfix">
				<input id="ajSqrId" type="hidden" name="ajSqrId"/>
				<div id="sqrBox" class="multiBox fl"></div>
				<span id="addSqrBtn" class="addSpan fl">添加/编辑申请人</span>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"><span class="mustItem hideItem">*</span>事务联系人</label>
			<div class="layui-input-block fixHeiDiv clearfix">
				<input id="ajLxrId" type="hidden" name="ajLxrId"/>
				<div class="multiBox fl" style="width:100%;">
					<div id="lxrBox" class="multiBox fl"></div>
					<span id="addlxrBtn" opts="addLxrOpts" class="addSpan fl">添加/编辑事务联系人</span>
				</div>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"><span class="mustItem hideItem">*</span>发明人</label>
			<div class="layui-input-block fixHeiDiv clearfix">
				<input id="ajFmrId" type="hidden" name="ajFmrId"/>
				<div class="multiBox fl" style="width:100%;">
					<div id="fmrBox" class="multiBox fl"></div>
					<span id="addFmrBtn" opts="addFmrOpts" class="addSpan fl">添加/编辑发明人</span>
				</div>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"><span class="mustItem">*</span>技术联系人</label>
			<div class="layui-input-block fixHeiDiv clearfix">
				<input id="jsLxrIdInp" type="hidden" name="jsLxrIdInp"/>
				<div class="multiBox fl" style="width:100%;">
					<div id="techLxrBox" class="multiBox fl"></div>
					<span id="addJsLxrBtn" opts="addJsLxrOpts" class="addSpan fl">添加/编辑技术联系人</span>
				</div>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"><span class="mustItem">*</span>付款方</label>
			<div class="layui-input-block">
				<input id="payerInp" type="text" maxlength="30" placeholder="请添加付款方" autocomplete="off" class="layui-input"/>	
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label">优先权</label>
			<div class="blockDiv fixHeiDiv clearfix">
				<input id="yxqDetailInp" type="hidden" name="yxqDetail"/>
				<div id="yxqBox">
					<div id="innerYxqBox"></div>
					<span id="addYxqBtn" class="addSpan margLAddSp fl">添加优先权</span>
				</div>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label singleYqTxt">案件额外要求</label>
			<input id="ajEwyqId" type="hidden" name="ajEwyqId"/>
			<input id="tmpAjEwyqId" type="hidden"/>
			<div id="ewyqBox" class="layui-input-block"><p class="ewyqTips">请先选择专利类型</p></div>
		</div>
		<div id="xxEyYqBox" class="layui-form-item"></div>
		<div class="layui-form-item">
			<label class="layui-form-label">案件备注</label>
			<div class="layui-input-block">
				<textarea id="ajRemark" name="ajRemark" placeholder="请输入案件备注(80字以内)" class="layui-textarea" maxlength="80"></textarea>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"><span class="mustItem">*</span>定稿提交截止时间</label>
			<div class="layui-input-inline">
				<input type="text" class="layui-input" id="cpyDateInp" name="cpyDate"/>
			</div>
			<div class="layui-form-mid layui-word-aux">(系统默认一个月)</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"><span class="mustItem zlNoMustBe"></span>案件附件</label>
			<div class="layui-input-block">
				<button id="selAjTypeBtn" type="button" class="layui-btn layui-btn-normal">选择文件</button>
				<button id="selFileBtn" type="button" class="layui-btn layui-btn-normal">选择文件</button> 
				<span class="noticeSpan">注：附件中单个图片大小不能超过5M，单个文件大小不能超过10M (非必填项)，最多可上传5个文件</span>
				<button type="button" class="layui-btn" id="upListAction">上传附件</button>
			</div>
		</div>
		<div class="layui-form-item">
			<input id="fujianInp" name="zlUpCl" type="hidden"/>
			<div class="layui-input-block tabParents">
				<table class="layui-table" style="width:100%;">
			      <thead>
			        <tr><th>附件名</th>
			        <th>附件类型</th>
			        <th>专利类型</th>
			        <th>大小</th>
			        <th>状态</th>
			        <th>进度</th>
			        <th>操作</th>
			      </tr></thead>
			      <tbody id="upLoadFileList"></tbody>
			    </table>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"></label>
			<div class="layui-input-block" style="width:75%;text-align:center;">
				<button type="button" id="saveZlBtn" class="layui-btn" style="width:120px;margin-left:0px;">保存专利</button>
			</div>
		</div>
	</div>
	<script src="/plugins/jquery/jquery-1.7.2.min.js"></script>
	<script src="/Module/zlBasicInfoManager/js/delMethod.js"></script>
	<script src="/plugins/layui/layui.js"></script>
	<script type="text/javascript">
		var num=0,tmpEwyqIdArray=[],tmpEwyqIdArray_xx=[],zlId=0,upSuccSrcArray = [],addEditZlOpts = parent.addEditZlOpts,isHasLxrFlag = false,isHasFmrFlag = false,isHasJsLxrFlag=false,fieldArray=[],sqrArray=[],sqrIdArray=[],sqrTxtArray=[],lxrIdArray=[],lxrIdNum=[],fmrIdNum=[],fmrIdArray=[],jsLxrIdNum=[],jsLxrIdArray=[],addCustFlag=false,tmpLxrFmrOpts='',isZlAddFmLxFlag=true;
		var colorArray = ['blue','red','pink','green','black'];
		layui.config({
			base: '/plugins/frame/js/'
		}).extend({ //设定组件别名
			common: 'common',// 表示模块文件的名字
			zlInfoMethod : 'zlInfoMethod',
		    globalUpload: 'upLoadFiles'// 表示模块文件的名字
		}).use(['layer','laydate','form','common','zlInfoMethod','upLoadFiles'],function(){
			var layer = layui.layer,
				form = layui.form,
				common = layui.common,
				zlInfoMethod = layui.zlInfoMethod,
				laydate = layui.laydate,
				globalUpload = layui.upLoadFiles;
			//监听案件类型
			form.on('radio(ajTypeRadFilter)', function(data){
				var value = data.value;
				$('#anjianType').val(value);
				$('.zlPatternNum').html('');
				$('#ajSqZlNum').val('');
				if(value == 'old'){
					$('.feeDiv').show();
					$('.hideItem').show();
					$('.zlNoMustBe').html('*');
					$('#rateInp').val(page.data.tmpFeeInpVal);
					$('#ajSqZlNum').attr('disabled',false);
					if($('#zlTypeInp').val() == 'fmxx'){
						var zlNumDomStr = zlInfoMethod.createFmXxZlNumDom();
						$('#zlNumBoxWrap').append(zlNumDomStr);
						$('.originZlNumBox').hide().find('input').attr('disabled','disabled');
					}
					if($('#zlTypeInp').val() != 'fmxx'){
						zlInfoMethod.checkOldAjNumPattern('ajSqZlNum','');
					}else{
						zlInfoMethod.checkOldAjNumPattern('fmZlNumInp','fmZlNum');
						zlInfoMethod.checkOldAjNumPattern('xxZlNumInp','xxZlNum');
					}
				}else{
					$('.feeDiv').hide();
					$('.hideItem').hide();
					page.data.tmpFeeInpVal = $('#rateInp').val();
					$('#rateInp').val('');
					$('.zlNoMustBe').html('');
					$('#ajSqZlNum').val('').attr('disabled',true);
					if($('#fmxxZlNumWrap').length > 0){
						$('#fmxxZlNumWrap').remove();
						$('.originZlNumBox').show().find('input').attr('disabled','disabled');
					}
				}
				$('.uploadInpHid').removeClass('fmPathInp xxPathInp xxPathInp_dg fmPathInp_dg ajDgPathInp');
				$('#selAjTypeBtn').hide();
				$('#selFileBtn').show();
				if($('.ajFjTypeTxt').length > 0){//先选择了附件上传
					var zlAjTypeStr = globalUpload.switchZlAjNewOrOld(value);
					$('.ajFjTypeTxt').each(function(i){
						$('.ajFjTypeTxt').eq(i).html(zlAjTypeStr);
						form.render();
					});
				}
			});
			//代理费费用收取提醒方式
			form.on('radio(remindInpFilter)', function(data){
				var value = data.value;
				$('#remindInp').val(value);
				zlInfoMethod.clearResetDlFee();
			});
			//专利类型form radio监听事件
			form.on('radio(zlTypeFilter)', function(data){
				var value = data.value;
				var dlFeeNum =  zlInfoMethod.getCpyDlFee(value);//获取代理机构指定专利类型费用;
				$('#zlTypeInp').val(value);
				tmpEwyqIdArray.length = 0;
				tmpEwyqIdArray_xx.length = 0;
				zlInfoMethod.agentFeeInpShow();
				if(value == 'fmxx'){
					page.data.isFmxxOpts = 'fm';
					$('.zlPatternNum').html('');
					$('.selZlTaskSp').hide();
					$('.singleDlFee').html('发明专利代理费参考费用：¥<span id="singDlFeeNum"></span>元');
					$('.secInitDlFee').html('新型专利代理费参考费用：¥<span id="xxDlFeeNum"></span>元');
					$('#singDlFeeNum').text(dlFeeNum.split('-')[0]);
					$('#xxDlFeeNum').text(dlFeeNum.split('-')[1]);
					$('.fmxxDlFee_xx').show();
					$('#addDlFeeBtn').html('添加发明专利代理费');
					zlInfoMethod.data.isXxFeeFlag = true;
					$('#ajNumInp').val('');
					if($('#anjianType').val() == 'old' && zlInfoMethod.data.onlyOneFlag_zlNum){//旧案 增加发明和新型专利号
						var zlNumDomStr = zlInfoMethod.createFmXxZlNumDom();
						$('#zlNumBoxWrap').append(zlNumDomStr);
						$('.originZlNumBox').hide().find('input').val('').attr('disabled','disabled');
						//检测旧案下专利号格式
						zlInfoMethod.checkOldAjNumPattern('fmZlNumInp','fmZlNum');
						zlInfoMethod.checkOldAjNumPattern('xxZlNumInp','xxZlNum');
					}
					$('.dlFeeNum_dan').attr('placeholder','请输入发明专利代理费');
					if(zlInfoMethod.data.onlyOneFlag_tit){
						//发明+新型下创建两个标题
						zlInfoMethod.data.singleZlTitFlag = false;
						var fmxxZlTitStr = zlInfoMethod.createFmxxZlTitDom();
						$('#zlTitleBox').append(fmxxZlTitStr);
						$('.originZlTitBox').hide().find('input').val('').attr('disabled','disabled');
						zlInfoMethod.data.switchZlTitFlag = false;//打开判断案件标题是否为空的第二个条件 组合变false
					}
					zlInfoMethod.data.onlyOneFlag_tit = false;
					zlInfoMethod.data.onlyOneFlag_zlNum = false;
					var reg = /^[A-Za-z0-9\u4e00-\u9fa5]+$/;
					$('#fmZlTitInp').on('blur',function(){
						if(!reg.test($.trim($('#fmZlTitInp').val()))){
							zlInfoMethod.data.tmpFmTitFlag = false;
							layer.msg('案件标题不能含有标点符号和特殊字符', {icon:5,anim:6,time:2000});
						}else{
							zlInfoMethod.data.tmpFmTitFlag = true;
						}	
					});
					$('#xxZlTitInp').on('blur',function(){
						if(!reg.test($.trim($('#xxZlTitInp').val()))){
							zlInfoMethod.data.tmpXxTitFlag = false;
							layer.msg('案件标题不能含有标点符号和特殊字符', {icon:5,anim:6,time:2000});
						}else{
							zlInfoMethod.data.tmpXxTitFlag = true;
						}	
					});
				}else{
					$('#xxEyYqBox').html('').hide();//清空新型额外要求内容
					page.data.isClickwgXXFlag = true;
					zlInfoMethod.data.onlyOneFlag_tit = true;//打开让切换到组合类型时还可以重新创建title
					zlInfoMethod.data.onlyOneFlag_zlNum = true;//打开让切换到组合类型时还可以重新创建zlNum
					page.data.isFmxxOpts = '';
					$('.selZlTaskSp').show();
					$('.fmxxDlFee_xx').hide();
					zlInfoMethod.getAjNum(value);
					zlInfoMethod.data.isClickZlTypeFlag = true;
					zlInfoMethod.agentFeeTxtByZlType(value);
					$('.secInitDlFee').html('');
					$('#singDlFeeNum').text(dlFeeNum);
					$('#dlFeeListWrap_xx').html('');
					multiDlFeeNum = 0;
					$('#fmxxZlTitBox').remove();
					$('.originZlTitBox').show().find('input').attr('disabled',false);
					zlInfoMethod.data.switchZlTitFlag = true;//打开判断案件标题是否为空的第二个条件 单个变true
					if($('#anjianType').val() == 'old'){
						$('#ajSqZlNum').val('');
						$('.zlPatternNum').html('');
						$('#fmxxZlNumWrap').remove();
						$('.originZlNumBox').show().find('input').attr('disabled',false);
						//检测旧案专利号
						zlInfoMethod.checkOldAjNumPattern('ajSqZlNum','');
					}
					if(value == 'fm'){
						$('.dlFeeNum_dan').attr('placeholder','请输入发明专利代理费');
					}else if(value == 'wg'){
						$('.dlFeeNum_dan').attr('placeholder','请输入外观专利代理费');
					}else{
						$('.dlFeeNum_dan').attr('placeholder','请输入实用新型专利代理费');
					}
				}
				if($('#remindInp').val() == 1 && $('.shiwuSelect').length > 0){
					var strHtml = '<option value="sc">实质审查通知书</option>';
					if(value == 'fm' || value == 'fmxx' && page.data.isFmxxOpts == 'fm'){
						$('.shiwuSelect').each(function(i){
							if($('.shiwuSelect').eq(i).find('option[value=sc]').length == 0){
								$('.shiwuSelect').eq(i).append(strHtml);
							}
						});
						if($('.xxSelect').length > 0){//发明+新型 下新型这块的select
							$('.xxSelect').each(function(i){
								$('.xxSelect').eq(i).find('option[value=sc]').remove();
							});
						}
					}else{
						if($('.singleSelect').length == 4){
							$('.singleDlFeeList').eq(0).remove();
						}
						$('.singleSelect').each(function(i){
							$('.singleSelect').eq(i).find('option[value=sc]').remove();
							//假如删除的第一个不是实质审查通知书，当切换到新型和外观的时候，将剩下存在实质通知书的value值给清空
							if($('.singleInp_shiwu').eq(i).val() == 'sc'){
								$('.singleInp_shiwu').eq(i).val('');
							}
						});
					}
					form.render();
				}
				$('#pubZlIdInp').val('');
				parent.$('#lqZlIdInp').val('');
				$('#pubZlIdInpTxt').val('');
				parent.$('#lqZlIdInpText').val('');
				zlInfoMethod.getEwYqList(value);
				$('.uploadInpHid').removeClass('fmPathInp xxPathInp xxPathInp_dg fmPathInp_dg');
				if($('.zlTypeTxt').length > 0){//先选择了附件上传
					var zlTypeTxt = globalUpload.switchZlTypeCHN(value);
					$('.zlTypeTxt').each(function(i){
						$('.zlTypeTxt').eq(i).html(zlTypeTxt);
						form.render();
					});
				}
				//选择专利类型的时候，同时需要判断当前选择附件类型是否存在 如果存在并且对附件类型已经做出了选择，
				//需要根据当前的附件类型针对专利类型下这块显示不同的内容
				if($('.ajFjTypeInp').length > 0){
					$('.ajFjTypeInp').each(function(i){
						if($('.ajFjTypeInp').eq(i).val() == 'ht'){//表示附件类型是合同文件
							$('.zlTypeTxt').eq(i).html('<p class="noZlTypeTxt">无需指派专利类型</p>');
						}
					});
				}
			});
			var page = {
				data : {
					isClickwgXXFlag : false,//用来检测是否点击实用新型和外观的标识，一旦点击，变为true,从而，防止重复创建实质审查申请书
					isFmxxOpts : '',
					tmpFeeInpVal : ''
				},
				init : function(){
					this.onLoad();
				},
				onLoad : function(){
					if(addEditZlOpts == 'editZlOpts'){//表示编辑
						var _this = this;
						layer.load('1');
						$.ajax({
		   					type:'post',
		   			        dataType:'json',
		   			        data:{zlId : parent.globalZlId,opt:'basic'},
		   			        url:'/zlm.do?action=getZlDetail',
		   			        success:function (json){
		   			        	layer.closeAll('loading');
		   			        	if(json['result'] == 'success'){
		   			        		zlId = json.ajId;
		   			        		_this.renderZlBasicInfo(json);
		   			        		_this.bindEvent();
		   			        		$('#titSpan').html('编辑专利[<em style="color:#F47837;font-style:normal;">'+ json.ajTitle +'</em>]');
		   			        	}else if(json['result'] == 'error'){
		   			        		layer.msg('系统错误，请稍后重试', {icon:5,anim:6,time:1000});
		   			        	}else if(json['result'] == 'noAbility'){
		   			        		layer.msg('系统错误，请稍后重试', {icon:5,anim:6,time:1000});
		   			        	}else if(json['result'] == 'noInfo'){
		   			        		layer.msg('暂无此专利信息', {icon:5,anim:6,time:1000});
		   			        	}
		   			        }
		   				});
					}else{//表示增加 onload直接调用上传这个方法
						this.bindEvent();
						$('#titSpan').html('增加新专利');
						zlInfoMethod.selectFileUpload();
						zlInfoMethod.getCpyDate();
					}
				},
				bindEvent : function(){
					var _this = this;
					//点击选择文件检测是否选择了新案件或旧案件
					$('#selAjTypeBtn').on('click',function(){
						var anjianTypeVal = $('#anjianType').val();
						if(anjianTypeVal == ''){
							layer.msg('请先选择案件类型', {icon:5,anim:6,time:1500});
						}
					});
					//关闭整个弹层
					$('.closeBtns').on('click',function(){
						var index= parent.layer.getFrameIndex(window.name);
        				parent.layer.close(index);
					});
					zlInfoMethod.bindEvent_comMet();
				},
				//编辑时渲染结构
				renderZlBasicInfo : function(json){
					var strHtml = '',isReadFlag = true,zlTypeTxtStr='';
					//新案、旧案
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"><span class="mustItem">*</span>案件类型</label><div class="layui-input-block"><input type="hidden" id="anjianType" value="'+ json.ajType1 +'"/>';
					if(json.ajType1 == 'new'){
						strHtml += '<input type="radio" name="ajTypeRad" class="ajTypeRad" lay-filter="ajTypeRadFilter" value="new" title="新案" checked/>';
					}else if(json.ajType1 == 'old'){
						strHtml += '<input type="radio" name="ajTypeRad" class="ajTypeRad" lay-filter="ajTypeRadFilter" value="old" title="旧案(中途转入)" checked/>';
					}
					strHtml += '</div></div>';
					//案件标题
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"><span class="mustItem">*</span>案件标题</label><div class="layui-input-block">';
					strHtml += '<input id="ajTitleInp" type="text" name="ajTitle" placeholder="请输入案件标题(40字以内)" maxlength="40" value="'+ json.ajTitle +'" autocomplete="off" class="layui-input"/></div></div>';
					//专利类型
					strHtml += '<div class="layui-form-item">';
					strHtml += '<div class="itemDiv"><label class="layui-form-label"><span class="mustItem">*</span>专利类型</label><input id="zlTypeInp" name="ajType" type="hidden" value="'+ json.ajType +'"/><div class="layui-input-inline">';
					if(json.ajType == 'fm'){
						zlTypeTxtStr = '发明';
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="fm" title="发明" checked/>';
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="syxx" title="实用新型"/>';
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="wg" title="外观"/>';
					}else if(json.ajType == 'syxx'){
						zlTypeTxtStr = '实用新型';
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="fm" title="发明"/>';
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="syxx" title="实用新型" checked/>';
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="wg" title="外观"/>';
					}else if(json.ajType == 'wg'){
						zlTypeTxtStr = '外观';
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="fm" title="发明"/>';
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="syxx" title="实用新型"/>';
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="wg" title="外观" checked/>';
					}
					strHtml += '</div></div>';
					if(json.ajType1 == 'old'){
						strHtml += '<div class="itemDiv feeDiv" style="display:block;"><label class="layui-form-label titLabel"><span class="mustItem">*</span>是否费减</label><input id="rateInp" type="hidden" value="'+ json.ajFjInfo +'"/>';
						strHtml += '<div class="layui-input-inline">';
						if(json.ajFjInfo == 0){
							strHtml += '<input type="radio" name="feeRateInp" value="0" lay-filter="isHasFeeRateFilter" title="无费减" checked/>';
							strHtml += '<input type="radio" name="feeRateInp" lay-filter="isHasFeeRateFilter" value="0.7" title="70%"/>';
							strHtml += '<input type="radio" name="feeRateInp" lay-filter="isHasFeeRateFilter" value="0.85" title="85%"/>';	
						}else if(json.ajFjInfo == 0.7){
							strHtml += '<input type="radio" name="feeRateInp" value="0" lay-filter="isHasFeeRateFilter" title="无费减">';
							strHtml += '<input type="radio" name="feeRateInp" lay-filter="isHasFeeRateFilter" value="0.7" title="70%" checked/>';
							strHtml += '<input type="radio" name="feeRateInp" lay-filter="isHasFeeRateFilter" value="0.85" title="85%"/>';
						}else if(json.ajFjInfo == 0.85){
							strHtml += '<input type="radio" name="feeRateInp" value="0" lay-filter="isHasFeeRateFilter" title="无费减">';
							strHtml += '<input type="radio" name="feeRateInp" lay-filter="isHasFeeRateFilter" value="0.7" title="70%">';
							strHtml += '<input type="radio" name="feeRateInp" lay-filter="isHasFeeRateFilter" value="0.85" title="85%" checked/>';
						}
						strHtml += '</div></div>';	
					}
					strHtml += '</div>';
					//案件编号 && 案件申请号/专利号
					strHtml += '<div class="layui-form-item clearfix"><div class="itemDiv"><label class="layui-form-label">案件编号</label><div class="layui-input-inline">';
					strHtml += '<input id="ajNumInp" type="text" disabled autocomplete="off" value="'+ json.ajNo +'" class="layui-input"/></div></div>';
					strHtml += '<div class="itemDiv"><label class="layui-form-label"><span class="mustItem zlNoMustBe"></span>案件申请号/专利号</label><div class="layui-input-inline">';
					if(json.ajType1 == 'new'){
						strHtml += '<input id="ajSqZlNum" maxlength="20" type="text" name="ajSqZlNum" disabled autocomplete="off" value="'+ json.ajNoGf +'" class="layui-input"/></div></div></div>';	
					}else{
						strHtml += '<input id="ajSqZlNum" maxlength="20" type="text" name="ajSqZlNum" autocomplete="off" value="'+ json.ajNoGf +'" class="layui-input"/></div></div></div>';
					}
					//已领取专利任务
					strHtml += '<div class="layui-form-item clearfix">';
					strHtml += '<div class="itemDiv"><label class="layui-form-label">已领取专利任务</label><div class="layui-input-inline">';
					strHtml += '<input id="pubZlIdInp" type="hidden" value="'+ json.pubZlId +'" name="pubZlId"/>';
					strHtml += '<input id="pubZlIdInpTxt" type="text" disabled autocomplete="off" value="'+ json.pubZlName +'" class="layui-input" style="width:94%"/>';
					strHtml += '<span class="selZlTaskSp" title="选择"><i class="layui-icon layui-icon-more"></i></span>';
					strHtml += '<span class="resetSp" title="重置"><i class="layui-icon layui-icon-delete"></i></span></div></div>';
					strHtml += '<div class="itemDiv"><div class="diffDiv oneWid fl">';
					strHtml += '<label class="layui-form-label"><i class="diffTit">专利难易程度</i></label>';
					strHtml += '<div class="layui-input-inline"><div id="diffLevelOne"></div></div></div></div>';
					strHtml += '</div>';
					//专利难易度 专利代理费用
					strHtml += '<div class="layui-form-item">';
					strHtml += '<div class="agentFeeDiv"><label class="layui-form-label"><span class="mustItem">*</span>专利代理费</label>';
					strHtml += '<div class="layui-input-block"><div class="agentBox" style="display:block;">';
					strHtml += '<div class="initDlFeeBox fl"><p class="getTypeTxt fl">提醒方式</p>';
					strHtml += '<div class="getDlFeeType fl"><input type="hidden" id="remindInp" value="'+ json.feeTxType +'"/>';
					if(json.feeTxType == 0){//时间提醒
						if(json.feeTxFlag){
							strHtml += '<input type="radio" name="remindInpRad" lay-filter="remindInpFilter" value="0" title="时间提醒" checked/>';
						}else{
							strHtml += '<input type="radio" name="remindInpRad" lay-filter="remindInpFilter" value="0" title="时间提醒" checked/>';
							strHtml += '<input type="radio" name="remindInpRad" lay-filter="remindInpFilter" value="1" title="事务提醒"/>';
						}
					}else if(json.feeTxType == 1){//事务提醒
						if(json.feeTxFlag){
							strHtml += '<input type="radio" name="remindInpRad" lay-filter="remindInpFilter" value="1" title="事务提醒" checked/>';
						}else{
							strHtml += '<input type="radio" name="remindInpRad" lay-filter="remindInpFilter" value="0" title="时间提醒"/>';
							strHtml += '<input type="radio" name="remindInpRad" lay-filter="remindInpFilter" value="1" title="事务提醒" checked/>';
						}
					}
					strHtml += '</div><p class="initFeeTxt fl"><i class="layui-icon layui-icon-tips"></i><span class="singleDlFee"></span><span class="secInitDlFee"></span></p></div>';
					strHtml += '<div class="addDlFeeBox fmxxDlFee fl">';
					strHtml += '<div id="dlFeeListWrap">';
					singleDlFeeNum = json.feeTxInfo.length;
					for(var i=0;i<json.feeTxInfo.length;i++){
						strHtml += '<div class="dlFeeList singleDlFeeList layui-form layui-clear">';
						if(json.feeTxType == 0){//时间提醒
							strHtml += '<input type="text" id="remdDateInp_'+ (i+1) +'" class="layui-input remindDateInp" value="'+ json.feeTxInfo[i].feeTxOpt +'" placeholder="请选择提醒日期" autocomplete="off"/>';
						}else if(json.feeTxType == 1){//事务提醒
							strHtml += '<div class="shiwuSel layui-form">';
							strHtml += '<input type="hidden" value="'+ json.feeTxInfo[i].feeTxOpt +'" class="shiwuInp singleInp_shiwu"/>';
							strHtml += '<select class="shiwuSelect singleSelect" lay-filter="shiwuSelectFilter">';
							strHtml += '<option value="">请选择事务</option>';
							if(json.feeTxInfo[i].feeTxOpt == 'sl'){
								strHtml += '<option value="sl" selected>受理通知书</option>';
								strHtml += '<option value="gb">公布通知书</option>';
								if(json.ajType == 'fm'){
									strHtml += '<option value="sc">实质审查通知书</option>';
								}
								strHtml += '<option value="sq">授权通知书</option>';
							}else if(json.feeTxInfo[i].feeTxOpt == 'gb'){
								strHtml += '<option value="sl">受理通知书</option>';
								strHtml += '<option value="gb" selected>公布通知书</option>';
								if(json.ajType == 'fm'){
									strHtml += '<option value="sc">实质审查通知书</option>';
								}
								strHtml += '<option value="sq">授权通知书</option>';
							}else if(json.feeTxInfo[i].feeTxOpt == 'sc'){
								strHtml += '<option value="sl">受理通知书</option>';
								strHtml += '<option value="gb">公布通知书</option>';
								strHtml += '<option value="sc" selected>实质审查通知书</option>';
								strHtml += '<option value="sq">授权通知书</option>';
							}else if(json.feeTxInfo[i].feeTxOpt == 'sq'){
								strHtml += '<option value="sl">受理通知书</option>';
								strHtml += '<option value="gb">公布通知书</option>';
								if(json.ajType == 'fm'){
									strHtml += '<option value="sc">实质审查通知书</option>';
								}
								strHtml += '<option value="sq" selected>授权通知书</option>';
							}
							strHtml += '</select></div>';
						}
						strHtml += '<div class="dlFeeNumBox"><em class="moneyDec">¥</em>';
						strHtml += '<input id="dlFeeInpNum_'+ (i+1) +'" type="text" class="layui-input dlFeeInpNum dlFeeNum_dan" placeholder="请输入'+ zlTypeTxtStr +'专利代理费" value="'+ json.feeTxInfo[i].feePrice +'"/></div>';
						strHtml += '<i id="delDlFee_'+ (i+1) +'" class="layui-icon layui-icon-delete delDlFee" title="删除"></i>';
						strHtml += '</div>';
					}
					strHtml += '</div>';
					strHtml += '<span id="addDlFeeBtn" class="addSpan fl">添加代理费</span></div>';
					strHtml += '</div></div></div></div>';
					//案件技术领域
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"><span class="mustItem">*</span>案件技术领域</label><div class="layui-input-block fixHeiDiv clearfix">';
					strHtml += '<div id="fieldBox" class="multiBox fl">';
					for(var i=0;i<json.jsFieldInfo.length;i++){
						if(json.jsFieldInfo[i].checked){
							strHtml += '<p id="fieldId_'+ json.jsFieldInfo[i].jsId +'" jffieldattrid="'+ json.jsFieldInfo[i].jsId +'" class="delFieldBtn"><span>'+ json.jsFieldInfo[i].jsName +'</span><i class="layui-icon layui-icon-close"></i></p>';	
							fieldArray.push('fieldId_'+json.jsFieldInfo[i].jsId);
						}
					}
					strHtml += '<input id="ajFieldId" type="hidden" name="ajFieldId"/></div>';
					strHtml += '<span id="addFieldBtn" class="addSpan fl">添加技术领域</span></div></div>';
					//案件申请地区
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"><span class="mustItem">*</span>案件申请地区</label>';
					strHtml += '<input id="ajSqAddress" type="hidden" name="ajSqAddress" value="'+ json.ajAddress +'"/><div class="layui-input-block fixHeiDiv clearfix">';
					if(json.ajAddress == '中国'){
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国" title="中国[CN]" checked/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国香港" title="中国香港[HK]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国台湾" title="中国台湾[TW]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="澳门" title="澳门[MO]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="日本" title="日本[JP]"/>';
					}else if(json.ajAddress == '中国香港'){
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国" title="中国[CN]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国香港" title="中国香港[HK]" checked/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国台湾" title="中国台湾[TW]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="澳门" title="澳门[MO]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="日本" title="日本[JP]"/>';
					}else if(json.ajAddress == '中国台湾'){
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国" title="中国[CN]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国香港" title="中国香港[HK]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国台湾" title="中国台湾[TW]" checked/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="澳门" title="澳门[MO]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="日本" title="日本[JP]"/>';
					}else if(json.ajAddress == '澳门'){
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国" title="中国[CN]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国香港" title="中国香港[HK]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国台湾" title="中国台湾[TW]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="澳门" title="澳门[MO]" checked/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="日本" title="日本[JP]"/>';
					}else{
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国" title="中国[CN]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国香港" title="中国香港[HK]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国台湾" title="中国台湾[TW]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="澳门" title="澳门[MO]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="日本" title="日本[JP]" checked/>';
					}
					strHtml += '</div></div>';
					//申请人
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"><span class="mustItem">*</span>申请人</label><input id="sqrIdInp" type="hidden"/>';
					strHtml += '<div class="layui-input-block fixHeiDiv clearfix"><input id="ajSqrId" type="hidden" value="'+ json.sqrId +'" name="ajSqrId"/>'; 
					strHtml += '<div id="sqrBox" class="multiBox fl">';
					var tmpArraySqrId = json.sqrId.split(',');
					var tmpArraySqrName = json.sqrName.split(',');
					sqrIdArray = tmpArraySqrId;
					sqrTxtArray = tmpArraySqrName;
					for(var i=0;i<tmpArraySqrName.length;i++){
						strHtml += '<div class="dgTjBox"><p id="sqrId_'+ tmpArraySqrId[i] +'" clsColor="'+ colorArray[i] +'" sqrattrname="'+ tmpArraySqrName[i] +'" sqrattrid="'+ tmpArraySqrId[i] +'" class="delSqrBtn '+ colorArray[i] +'"><span>'+ tmpArraySqrName[i] +'</span><i class="layui-icon layui-icon-close"></i></p><a class="getSqrDetailBtn" cusId="'+ tmpArraySqrId[i] +'" cusName="'+ tmpArraySqrName[i] +'" href="javascript:void(0)">详情</a></div>';
						sqrArray.push('sqrId_'+tmpArraySqrId[i]);
						//sqrIdArray.push(tmpArraySqrId[i]);
						//sqrTxtArray.push(tmpArraySqrName[i]);
					}
					strHtml += '</div><span id="addSqrBtn" class="addSpan fl">添加/编辑申请人</span>';
					strHtml += '</div></div>';
					//联系人
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"><span class="mustItem hideItem">*</span>事务联系人</label><div class="layui-input-block fixHeiDiv clearfix">';
					strHtml += '<input id="ajLxrId" type="hidden" value="'+ json.lxrId +'" name="ajLxrId"/><div class="multiBox fl" style="width:100%;">';
					strHtml += '<div id="lxrBox" class="multiBox fl">';
					if(json.lxrId != ''){
						var tmpArrayLxrId = json.lxrId.split(',');
						var tmpArrayLxrName = json.lxrName.split(',');
						var tmpArraySqrLxrId = json.sqrLxrId.split(',');
						lxrIdNum = tmpArrayLxrId;
						for(var i=0;i<tmpArrayLxrName.length;i++){
							strHtml += '<div class="dgTjBox"><p id="lxrId_'+ tmpArrayLxrId[i] +'" lxridattr="'+ tmpArrayLxrId[i] +'" sqrids="'+ tmpArraySqrLxrId[i] +'" class="lxFmTag delLxrBtn"><input type="hidden" class="lxrFmrInpHid" name="myParSqr_'+ tmpArraySqrLxrId[i] +'"><span>'+ tmpArrayLxrName[i] +'</span><i class="layui-icon layui-icon-close"></i></p><a class="getLxrInfoBtn" lxrId="'+ tmpArrayLxrId[i] +'" lxrName="'+ tmpArrayLxrName[i] +'" href="javascript:void(0)">详情</a></div>';
						}
					}
					strHtml += '</div><span id="addlxrBtn" opts="addLxrOpts" class="addSpan fl">添加/编辑事务联系人</span></div>';
					strHtml += '</div></div>';		
					//发明人
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"><span class="mustItem hideItem">*</span>发明人</label><div class="layui-input-block fixHeiDiv clearfix">';
					strHtml += '<input id="ajFmrId" type="hidden" name="ajFmrId" value="'+ json.fmrId +'"/><div class="multiBox fl" style="width:100%;">';
					strHtml += '<div id="fmrBox" class="multiBox fl">';	
					if(json.fmrId != ''){
						var tmpArrayFmrId = json.fmrId.split(',');
						var tmpArrayFmrName = json.fmrName.split(',');
						var tmpArraySqrFmrId = json.sqrFmrId.split(',');
						fmrIdNum = tmpArrayFmrId;
						for(var i=0;i<tmpArrayFmrName.length;i++){
							strHtml += '<div class="dgTjBox"><p id="fmrId_'+ tmpArrayFmrId[i] +'" fmridattr="'+ tmpArrayFmrId[i] +'" sqrids="'+ tmpArraySqrFmrId[i] +'" class="lxFmTag delFmrBtn"><input type="hidden" class="lxrFmrInpHid" name="myParSqr_'+ tmpArraySqrFmrId[i] +'">';
							if(i == 0){//指定第一发明人
								strHtml += '<span><em id="firstFmrId" class="firstNoteTxt fmrNoteTxt">[第一发明人]</em>'+ tmpArrayFmrName[i] +'</span><i class="layui-icon layui-icon-close"></i></p>';
							}else{
								strHtml += '<span>'+ tmpArrayFmrName[i] +'</span><i class="layui-icon layui-icon-close"></i></p>';
							}
							strHtml += '<a class="getFmrInfoBtn" fmrName="'+ tmpArrayFmrName[i] +'" fmrId="'+ tmpArrayFmrId[i] +'" href="javascript:void(0)">详情</a></div>';
						}	
					}
					strHtml += '</div><span id="addFmrBtn" opts="addFmrOpts" class="addSpan fl">添加/编辑发明人</span></div>';
					strHtml += '</div></div>';
					//技术联系人
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"><span class="mustItem">*</span>技术联系人</label><div class="layui-input-block fixHeiDiv clearfix">';
					strHtml += '<input id="jsLxrIdInp" type="hidden" value="'+ json.jsLxrId +'" name="jsLxrIdInp"/><div class="multiBox fl" style="width:100%;">';
					strHtml += '<div id="techLxrBox" class="multiBox fl">';
					if(json.jsLxrId != ''){
						var tmpArrayJsLxrId = json.jsLxrId.split(',');
						var tmpArrayJsLxrName = json.jsLxrName.split(',');
						var tmpArraySqrJsLxrId = json.sqrJsrId.split(',');
						jsLxrIdNum = tmpArrayJsLxrId;
						for(var i=0;i<tmpArrayJsLxrName.length;i++){
							strHtml += '<div class="dgTjBox"><p id="fmrId_'+ tmpArrayJsLxrId[i] +'" fmridattr="'+ tmpArrayJsLxrId[i] +'" sqrids="'+ tmpArraySqrJsLxrId[i] +'" class="lxFmTag delJsLxrBtn"><input type="hidden" class="lxrFmrInpHid" name="myParSqr_'+ tmpArraySqrJsLxrId[i] +'"><span>'+ tmpArrayJsLxrName[i] +'</span><i class="layui-icon layui-icon-close"></i></p><a  class="getJsLxrInfoBtn" fmrId="'+ tmpArrayJsLxrId[i] +'" fmrName="'+ tmpArrayJsLxrName[i] +'" href="javascript:void(0)">详情</a></div>';
						}
					}
					strHtml += '</div><span id="addJsLxrBtn" opts="addJsLxrOpts" class="addSpan fl">添加/编辑技术联系人</span></div>';
					strHtml += '</div></div>';
					//付款方
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"><span class="mustItem">*</span>付款方</label>';
					var payerPeo = json.payUserInfo == '' ? tmpArraySqrName[0] : json.payUserInfo;
					strHtml += '<div class="layui-input-block"><input id="payerInp" type="text" maxlength="30" value="'+ payerPeo +'" placeholder="请添加付款方" autocomplete="off" class="layui-input"/></div></div>';
					//案件优先权
					strHtml += '<div class="layui-form-item"><label class="layui-form-label">优先权</label><div class="blockDiv fixHeiDiv clearfix">';
					strHtml += '<input id="yxqDetailInp" type="hidden" name="yxqDetail"/><div id="yxqBox"><div id="innerYxqBox">';
					if(json.ajYxqDetail != ''){
						var tmpYxqZlNum = json.ajYxqDetail.split(':')[0].split(',');
						var tmpYxqSqArea = json.ajYxqDetail.split(':')[1].split(',');
						var tmpYxqDate = json.ajYxqDetail.split(':')[2].split(',');
						num = tmpYxqZlNum.length;
						for(var i=0;i<tmpYxqZlNum.length;i++){
							strHtml += '<div class="innerYxqBox">';
							strHtml += '<input placeholder="请输入案件申请号/专利号" type="text" value="'+ tmpYxqZlNum[i] +'" autocomplete="off" class="layui-input zlAjNumInp"/>';
							strHtml += '<div class="innerSelAddBox"><select class="zlYxqAreaInp" lay-filter="selAreaFilter">';
							strHtml += '<option value="">请选择</option>';
							if(tmpYxqSqArea[i] == '中国'){
								strHtml += '<option value="中国" selected>中国[CN]</option>';
								strHtml += '<option value="中国香港">中国香港[HK]</option>';
								strHtml += '<option value="中国台湾">中国台湾[TW]</option>';
								strHtml += '<option value="澳门">澳门[MO]</option>';
								strHtml += '<option value="日本">日本[JP]</option>';
							}else if(tmpYxqSqArea[i] == '中国香港'){
								strHtml += '<option value="中国">中国[CN]</option>';
								strHtml += '<option value="中国香港" selected>中国香港[HK]</option>';
								strHtml += '<option value="中国台湾">中国台湾[TW]</option>';
								strHtml += '<option value="澳门">澳门[MO]</option>';
								strHtml += '<option value="日本">日本[JP]</option>';
							}else if(tmpYxqSqArea[i] == '中国台湾'){
								strHtml += '<option value="中国">中国[CN]</option>';
								strHtml += '<option value="中国香港">中国香港[HK]</option>';
								strHtml += '<option value="中国台湾" selected>中国台湾[TW]</option>';
								strHtml += '<option value="澳门">澳门[MO]</option>';
								strHtml += '<option value="日本">日本[JP]</option>';
							}else if(tmpYxqSqArea[i] == '澳门'){
								strHtml += '<option value="中国">中国[CN]</option>';
								strHtml += '<option value="中国香港">中国香港[HK]</option>';
								strHtml += '<option value="中国台湾">中国台湾[TW]</option>';
								strHtml += '<option value="澳门" selected>澳门[MO]</option>';
								strHtml += '<option value="日本">日本[JP]</option>';
							}else if(tmpYxqSqArea[i] == '日本'){
								strHtml += '<option value="中国">中国[CN]</option>';
								strHtml += '<option value="中国香港">中国香港[HK]</option>';
								strHtml += '<option value="中国台湾">中国台湾[TW]</option>';
								strHtml += '<option value="澳门">澳门[MO]</option>';
								strHtml += '<option value="日本" selected>日本[JP]</option>';
							}
							strHtml += '</select></div>';
							strHtml += '<input placeholder="请选择日期" type="text" name="" autocomplete="off" id="dateInp_'+ (i+1) +'" value="'+ tmpYxqDate[i] +'" class="layui-input yxqInpDate"/>';
							strHtml += '<i class="layui-icon layui-icon-delete delYxqIcon"  title="删除"></i>';
							strHtml += '</div>';
						}
					}
					strHtml += '</div><span id="addYxqBtn" class="addSpan margLAddSp fl">添加优先权</span></div>';
					strHtml += '</div></div>';
					//案件额外要求
					strHtml += '<div class="layui-form-item"><label class="layui-form-label">案件额外要求</label>';
					strHtml += '<input id="ajEwyqId" type="hidden" name="ajEwyqId"/><input id="tmpAjEwyqId" type="hidden"/>';
					strHtml += '<div id="ewyqBox" class="layui-input-block">';
					if(json.yqInfo.length > 0){
						for(var i=0;i<json.yqInfo.length;i++){
							if(json.yqInfo[i].checked){
								strHtml += '<input type="checkbox" name="zlYqInfoInp" lay-filter="ewyqFilter" value="'+ json.yqInfo[i].yqId +'" title="'+ json.yqInfo[i].yaContent +'" lay-skin="primary" checked/>';
								tmpEwyqIdArray.push(json.yqInfo[i].yqId);
							}else{
								strHtml += '<input type="checkbox" name="zlYqInfoInp" lay-filter="ewyqFilter" value="'+ json.yqInfo[i].yqId +'" title="'+ json.yqInfo[i].yaContent +'" lay-skin="primary"/>';	
							}
						}
					}else{
						strHtml += '<p class="ewyqTips">无专利额外要求</p>';
					}
					strHtml += '</div></div>';
					//案件备注
					strHtml += '<div class="layui-form-item"><label class="layui-form-label">案件备注</label><div class="layui-input-block">';
					strHtml += '<textarea id="ajRemark" name="ajRemark" placeholder="请输入案件备注(80字以内)" class="layui-textarea" maxlength="80">'+ json.ajRemark +'</textarea>';
					strHtml += '</div></div>';
					//定稿提交截至时间
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"><span class="mustItem">*</span>定稿提交截止时间</label><div class="layui-input-inline">';
					strHtml += '<input type="text" class="layui-input" id="cpyDateInp" value="'+ json.cpyDate +'" name="cpyDate"/></div><div class="layui-form-mid layui-word-aux">(系统默认一个月)</div></div>';
					//案件附件
					strHtml += '<div class="layui-form-item"><label class="layui-form-label">案件附件</label><div class="layui-input-block">';
					strHtml += '<button type="button" class="layui-btn layui-btn-normal" id="selFileBtn" style="display:inline-block;">选择文件</button>';
					strHtml += '  <span class="noticeSpan">注：附件中单个图片大小不能超过5M，单个文件大小不能超过10M (非必填项)，最多可上传5个文件</span>';
					strHtml += '<button type="button" class="layui-btn" id="upListAction">上传附件</button></div></div>';
					
					strHtml += '<div class="layui-form-item"><input id="fujianInp" name="zlUpCl" type="hidden"/>';
					strHtml += '<div class="layui-input-block tabParents"><table class="layui-table" style="width:100%;"><thead>';
					strHtml += '<tr><th>附件名</th><th>附件类型</th><th>专利类型</th><th>大小</th><th>状态</th><th>进度</th><th>操作</th></tr></thead>';
					strHtml += '<tbody id="upLoadFileList">';
					var zlTypeTxt = globalUpload.switchZlTypeCHN(json.ajType);
					if(json.upFile.length > 0){
						var zlUpClArray = json.upFile; //技术底稿
						for(var i=0;i<zlUpClArray.length;i++){
							strHtml += '<tr id="upload-'+ i +'">';
							strHtml += '<td style="max-width:260px;">'+ zlUpClArray[i].fileName +'</td>';
							strHtml += '<td style="width:130px;"><p>技术底稿</p></td>';
							strHtml += '<td><div class="zlTypeTxt layui-form">'+ zlTypeTxt +'</div></td>';
							strHtml += '<td>'+ zlUpClArray[i].fileSize +'</td>';
							strHtml += '<td><span style="color: #5FB878;">上传成功</span></td>';
							strHtml += '<td style="width:120px;"><div class="layui-progress layui-progress-big" lay-showpercent="true">';
							strHtml += '<div class="layui-progress-bar progressBarBg" lay-percent="100%" style="width:100%;"><span class="layui-progress-text">100%</span></div></div>';
							strHtml += '</td>';
							strHtml += '<td>';
							strHtml += '<input class="uploadInpHid ajJsPathInp" name="hasUpSuccInp" value="'+ zlUpClArray[i].upPath +'" type="hidden"/>';
							strHtml += '<button class="layui-btn layui-btn-xs layui-btn-danger deleteBtn deleteBtn_edit">删除</button>';
							strHtml += '<button class="layui-btn layui-btn-xs downloadBtn" downFilePath="'+ zlUpClArray[i].downFilePath +'">下载</button></td>';
							strHtml += '</tr>';
						}
					}
					if(json.upFileDg != undefined && json.upFileDg.length > 0){
						var zlUpDgArray = json.upFileDg;//定稿文件
						for(var i=0;i<zlUpDgArray.length;i++){
							strHtml += '<tr id="upload-'+ i +'">';
							strHtml += '<td style="max-width:260px;">'+ zlUpDgArray[i].fileName +'</td>';
							strHtml += '<td style="width:130px;"><p>定稿文件</p></td>';
							strHtml += '<td><div class="zlTypeTxt layui-form"><p>'+ zlTypeTxt +'</p></div></td>';
							strHtml += '<td>'+ zlUpDgArray[i].fileSize +'</td>';
							strHtml += '<td><span style="color: #5FB878;">上传成功</span></td>';
							strHtml += '<td style="width:120px;"><div class="layui-progress layui-progress-big" lay-showpercent="true">';
							strHtml += '<div class="layui-progress-bar progressBarBg" lay-percent="100%" style="width:100%;"><span class="layui-progress-text">100%</span></div></div>';
							strHtml += '</td>';
							strHtml += '<td>';
							strHtml += '<input class="uploadInpHid ajDgPathInp" name="hasUpSuccInp" value="'+ zlUpDgArray[i].upPath +'" type="hidden"/>';
							strHtml += '<button class="layui-btn layui-btn-xs layui-btn-danger deleteBtn deleteBtn_edit">删除</button>';
							strHtml += '<button class="layui-btn layui-btn-xs downloadBtn" downFilePath="'+ zlUpDgArray[i].downFilePath +'">下载</button></td>';
							strHtml += '</tr>';
						}
					}
					if(json.upFileHt != undefined && json.upFileHt.length > 0){
						var zlUpHtArray = json.upFileHt;//合同文件
						for(var i=0;i<zlUpHtArray.length;i++){
							strHtml += '<tr id="upload-'+ i +'">';
							strHtml += '<td style="max-width:260px;">'+ zlUpHtArray[i].fileName +'</td>';
							strHtml += '<td style="width:130px;"><p>合同文件</p></td>';
							strHtml += '<td><div class="zlTypeTxt layui-form"><p class="noZlTypeTxt">无需指派专利类型</p></div></td>';
							strHtml += '<td>'+ zlUpHtArray[i].fileSize +'</td>';
							strHtml += '<td><span style="color: #5FB878;">上传成功</span></td>';
							strHtml += '<td style="width:120px;"><div class="layui-progress layui-progress-big" lay-showpercent="true">';
							strHtml += '<div class="layui-progress-bar progressBarBg" lay-percent="100%" style="width:100%;"><span class="layui-progress-text">100%</span></div></div>';
							strHtml += '</td>';
							strHtml += '<td>';
							strHtml += '<input class="uploadInpHid ajHtPathInp" name="hasUpSuccInp" value="'+ zlUpHtArray[i].upPath +'" type="hidden"/>';
							strHtml += '<button class="layui-btn layui-btn-xs layui-btn-danger deleteBtn deleteBtn_edit">删除</button>';
							strHtml += '<button class="layui-btn layui-btn-xs downloadBtn" downFilePath="'+ zlUpHtArray[i].downFilePath +'">下载</button></td>';
							strHtml += '</tr>';
						}
					}
					strHtml += '</tbody></table>';
					strHtml += '</div></div>';
					//保存按钮
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"></label><div class="layui-input-block" style="width:75%;text-align:center;">';
					strHtml += '<button type="button" id="saveZlBtn" class="layui-btn" style="width:120px;margin-left:0px;">保存专利</button></div></div>';
					$('#addNewZl').html(strHtml);
					commonAddColorCls();//不同申请人对应其下联系人 发明人 技术联系人 显示对应申请人色块
					json.ajType1 == 'old' ? $('.hideItem').show() : $('.hideItem').hide();
					form.render();
					for(var i=0;i<json.feeTxInfo.length;i++){
						laydate.render({
							elem:'#remdDateInp_' + (i+1),
							min:zlInfoMethod.getMinDate()
						});
						zlInfoMethod.agentDlFee_usual('dlFeeInpNum_'+(i+1));
						zlInfoMethod.delCurrDlFee('delDlFee_'+(i+1));
					}
					for(var i=0;i<num;i++){
						laydate.render({
							elem:'#dateInp_' + (i+1)
						});
					}
					if(json.ajYxqDetail != ''){	
						zlInfoMethod.delYxq();
					}
					laydate.render({
						elem: '#cpyDateInp'
					});
					zlInfoMethod.selectFileUpload();//编辑时渲染结构完成调用上传方法
					delHasAddMethod('delFieldBtn','delFieldOpt');
					delHasAddMethod('delSqrBtn','delSqrOpt');
					if(json.lxrId != ''){
						delHasAddMethod('delLxrBtn','delLxrOpt');
					}
					if(json.fmrId != ''){
						delHasAddMethod('delFmrBtn','delFmrOpt');
					}
					delHasAddMethod('delJsLxrBtn','delJsLxrOpt');
					if(json.pubZlName != ''){//编辑首次进来页面判断是否存在已添加的专利任务存在激活重置
						parent.$('#lqZlIdInp').val(json.pubZlId);//将已经存在数据库的pubZlId赋给父级用于弹窗页面的回显
			  		}
					$('.downloadBtn').on('click',function(){
						var downFilePath = $(this).attr('downFilePath');
						common.downFiles(downFilePath,0);
					});
					if(json.ajType1 == 'old'){
						zlInfoMethod.checkOldAjNumPattern('ajSqZlNum','');
					}
					common.rateFunReadOnly('diffLevelOne',json.zlLevel);
					zlInfoMethod.agentFeeTxtByZlType(json.ajType);
					var dlFeeNum =  zlInfoMethod.getCpyDlFee(json.ajType);//获取代理机构指定专利类型费用;
					$('#singDlFeeNum').text(dlFeeNum);
					//查看申请人 发明人 联系人基本信息
					viewDetInfo_cus();
					viewDetInfo_lxr();
					viewDetInfo_fmr();
					viewDetInfo_jslxr();
				}
			};
			$(function(){
				page.init();				
			});
		});
	</script>
</body> 
</html>