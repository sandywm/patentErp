<!DOCTYPE html>
<html> 
<head>
 	<meta charset="utf-8"/>
 	<link href="/plugins/layui/css/layui.css" rel="stylesheet" type="text/css"/>
 	<link href="/plugins/pace/pace-theme-flash.min.css" rel="stylesheet" type="text/css"/>
 	<link href="/Module/zlBasicInfoManager/css/zlBasicInfoManager.css" rel="stylesheet" type="text/css"/>
	<script src="/plugins/pace/pace.min.js" type="text/javascript"></script>
  	<title>增加新专利</title>
</head>
<body style="background:#fff;margin-top:50px;">
	<div class="layui-card-header headerWrap">
		<span id="titSpan"></span>
		<a class="closeBtns" href="javascript:void(0)"><i class="layui-icon layui-icon-close"></i></a>
	</div>
	<div id="addNewZl" class="layui-form">
		<div class="layui-form-item">
			<label class="layui-form-label"><span class="mustItem">*</span>案件标题</label>
			<div class="layui-input-block">
				<input id="ajTitleInp" type="text" name="ajTitle" placeholder="请输入案件标题(40字以内)" maxlength="40" autocomplete="off" class="layui-input"/>
			</div>				
		</div>
		<div class="layui-form-item clearfix">
			<div class="itemDiv">
				<label class="layui-form-label">案件编号</label>
				<div class="layui-input-inline">
					<input id="ajNumInp" type="text" disabled autocomplete="off" class="layui-input"/>
				</div>	
			</div>			
			<div class="itemDiv">
				<label class="layui-form-label">案件申请号/专利号</label>
				<div class="layui-input-inline">
					<input id="ajSqZlNum" type="text" name="ajSqZlNum" disabled autocomplete="off" class="layui-input"/>
				</div>	
			</div>			
		</div>
		<div class="layui-form-item clearfix">
			<div class="itemDiv">
				<label class="layui-form-label"><span class="mustItem">*</span>专利类型</label>
				<input id="zlTypeInp" name="ajType" type="hidden" value=""/>
				<div class="layui-input-inline">
					<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="fm" title="发明"/>
					<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="syxx" title="实用新型"/>
					<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="wg" title="外观"/>
					<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="fmxx" title="发明+新型"/>
				</div>	
			</div>	
			<div class="itemDiv">
				<label class="layui-form-label">已领取专利任务</label>
				<div class="layui-input-inline">
					<input id="pubZlIdInp" type="hidden" name="pubZlId"/>					
					<input id="pubZlIdInpTxt" type="text" disabled autocomplete="off" class="layui-input" style="width:94%"/>
					<span class="selZlTaskSp" title="选择"><i class="layui-icon layui-icon-more"></i></span>
					<span class="resetSp" title="重置"><i class="layui-icon layui-icon-delete"></i></span>
				</div>	
			</div>			
		</div>
		<div class="layui-form-item">
			<div class="itemDiv agentFeeDiv">
				<div class="comAgentDiv oneAgentDiv twoWid fl">
					<label class="layui-form-label"><span class="mustItem">*</span><i class="agentTit">专利代理费</i></label>
					<div class="layui-input-inline">
						<em class="moneyDec">¥</em>
						<input id="zlAgentFeeInp" type="text" placeholder="请输入代理费" autocomplete="off" class="layui-input agentInp"/>
					</div>
					<span class="tipsInfo">请先选择专利类型</span>
				</div>
				<div class="comAgentDiv twoAgentDiv twoWid fl">
					<label class="layui-form-label sepcialLab"><span class="mustItem">*</span><i class="agentTit"></i></label>
					<div class="layui-input-inline sepcialInline">
						<em class="moneyDec">¥</em>
						<input id="xxAgentFeeInp" type="text" placeholder="请输入代理费" autocomplete="off" class="layui-input agentInp"/>
					</div>
				</div>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"><span class="mustItem">*</span>案件技术领域</label>
			<div class="layui-input-block fixHeiDiv clearfix">
				<input id="ajFieldId" type="hidden" name="ajFieldId"/>
				<div id="fieldBox" class="multiBox fl"></div>
				<span id="addFieldBtn" class="addSpan fl">添加技术领域</span>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"><span class="mustItem">*</span>案件申请地区</label>
			<input id="ajSqAddress" type="hidden" name="ajSqAddress"/>
			<div class="layui-input-block fixHeiDiv clearfix">
				<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国" title="中国[CN]"/>
				<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国香港" title="中国香港[HK]"/>
				<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国台湾" title="中国台湾[TW]"/>
				<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="澳门" title="澳门[MO]"/>
				<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="日本" title="日本[JP]"/>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"><span class="mustItem">*</span>申请人</label>
			<input id="sqrIdInp" type="hidden"/>
			<div class="layui-input-block fixHeiDiv clearfix">
				<input id="ajSqrId" type="hidden" name="ajSqrId"/>
				<div id="sqrBox" class="multiBox fl"></div>
				<span id="addSqrBtn" class="addSpan fl">添加/编辑申请人</span>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label">联系人</label>
			<div class="layui-input-block fixHeiDiv clearfix">
				<input id="ajLxrId" type="hidden" name="ajLxrId"/>
				<div class="multiBox fl" style="width:100%;">
					<div id="lxrBox" class="multiBox fl"></div>
					<span id="addlxrBtn" opts="addLxrOpts" class="addSpan fl">添加/编辑联系人</span>
				</div>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label">发明人</label>
			<div class="layui-input-block fixHeiDiv clearfix">
				<input id="ajFmrId" type="hidden" name="ajFmrId"/>
				<div class="multiBox fl" style="width:100%;">
					<div id="fmrBox" class="multiBox fl"></div>
					<span id="addFmrBtn" opts="addFmrOpts" class="addSpan fl">添加/编辑发明人</span>
				</div>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"><span class="mustItem">*</span>技术联系人</label>
			<div class="layui-input-block fixHeiDiv clearfix">
				<input id="jsLxrIdInp" type="hidden" name="jsLxrIdInp"/>
				<div class="multiBox fl" style="width:100%;">
					<div id="techLxrBox" class="multiBox fl"></div>
					<span id="addJsLxrBtn" opts="addJsLxrOpts" class="addSpan fl">添加/编辑技术联系人</span>
				</div>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label">优先权</label>
			<div class="blockDiv fixHeiDiv clearfix">
				<input id="yxqDetailInp" type="hidden" name="yxqDetail"/>
				<div id="yxqBox">
					<div id="innerYxqBox"></div>
					<span id="addYxqBtn" class="addSpan margLAddSp fl">添加优先权</span>
				</div>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label">案件额外要求</label>
			<input id="ajEwyqId" type="hidden" name="ajEwyqId"/>
			<input id="tmpAjEwyqId" type="hidden"/>
			<div id="ewyqBpx" class="layui-input-block"><p class="ewyqTips">请先选择专利类型</p></div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label">案件备注</label>
			<div class="layui-input-block">
				<textarea id="ajRemark" name="ajRemark" placeholder="请输入案件备注(80字以内)" class="layui-textarea" maxlength="80"></textarea>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"><span class="mustItem">*</span>定稿提交截止时间</label>
			<div class="layui-input-inline">
				<input type="text" class="layui-input" id="cpyDateInp" name="cpyDate"/>
			</div>
			<div class="layui-form-mid layui-word-aux">(系统默认一个月)</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label">案件附件</label>
			<div class="layui-input-block">
				<button type="button" class="layui-btn layui-btn-normal" id="selFileBtn">选择文件</button> 
				<span class="noticeSpan">注：附件中单个图片大小不能超过5M，单个文件大小不能超过10M (非必填项)，最多可上传5个文件</span>
				<button type="button" class="layui-btn" id="upListAction">上传附件</button>
			</div>
		</div>
		<div class="layui-form-item">
			<input id="fujianInp" name="zlUpCl" type="hidden"/>
			<div class="layui-input-block">
				<table class="layui-table">
			      <thead>
			        <tr><th>附件名</th>
			        <th>专利类型</th>
			        <th>大小</th>
			        <th>状态</th>
			        <th>进度</th>
			        <th>操作</th>
			      </tr></thead>
			      <tbody id="upLoadFileList"></tbody>
			    </table>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"></label>
			<div class="layui-input-block" style="width:75%;text-align:center;">
				<button type="button" id="saveZlBtn" class="layui-btn" style="width:120px;margin-left:0px;">保存专利</button>
			</div>
		</div>
	</div>
	<script src="/plugins/jquery/jquery-1.7.2.min.js"></script>
	<script src="/Module/zlBasicInfoManager/js/delMethod.js"></script>
	<script src="/plugins/layui/layui.js"></script>
	<script type="text/javascript">
		var num=0,tmpEwyqIdArray=[],zlId=0,upSuccSrcArray = [],addEditZlOpts = parent.addEditZlOpts,isHasLxrFlag = false,isHasFmrFlag = false,isHasJsLxrFlag=false,fieldArray=[],sqrArray=[],sqrIdArray=[],sqrTxtArray=[],lxrIdArray=[],lxrIdNum=[],fmrIdNum=[],fmrIdArray=[],jsLxrIdNum=[],jsLxrIdArray=[],addCustFlag=false,tmpLxrFmrOpts='',isZlAddFmLxFlag=true;
		layui.config({
			base: '/plugins/frame/js/'
		}).extend({ //设定组件别名
			common: 'common',// 表示模块文件的名字
			zlInfoMethod : 'zlInfoMethod',
		    globalUpload: 'upLoadFiles'// 表示模块文件的名字
		}).use(['layer','laydate','form','common','zlInfoMethod','upLoadFiles'],function(){
			var layer = layui.layer,
				form = layui.form,
				common = layui.common,
				zlInfoMethod = layui.zlInfoMethod,
				laydate = layui.laydate,
				globalUpload = layui.upLoadFiles;
			//专利类型form radio监听事件
			form.on('radio(zlTypeFilter)', function(data){
				var value = data.value;
				var dlFeeNum =  zlInfoMethod.getCpyDlFee(value);//获取代理机构指定专利类型费用;
				$('#zlTypeInp').val(value);
				tmpEwyqIdArray.length = 0;
				if(value == 'fmxx'){
					$('.selZlTaskSp').hide();
					$('.oneAgentDiv').addClass('twoWid').removeClass('oneWid');
					$('.twoAgentDiv').show();
					$('.oneAgentDiv ').find('.agentTit').html('发明专利代理费');
					$('.twoAgentDiv ').find('.agentTit').html('新型专利代理费');
					zlInfoMethod.agentDlFee_special();
					zlInfoMethod.data.isXxFeeFlag = true;
					$('#ajNumInp').val('');
					$('#zlAgentFeeInp').val(dlFeeNum.split('-')[0]);
					$('#xxAgentFeeInp').val(dlFeeNum.split('-')[1]);
				}else{
					$('.selZlTaskSp').show();
					zlInfoMethod.getAjNum(value);
					zlInfoMethod.data.isClickZlTypeFlag = true;
					zlInfoMethod.agentFeeTxtByZlType(value);
					$('#zlAgentFeeInp').val(dlFeeNum);
				}
				zlInfoMethod.agentFeeInpShow();
				$('#pubZlIdInp').val('');
				parent.$('#lqZlIdInp').val('');
				$('#pubZlIdInpTxt').val('');
				parent.$('#lqZlIdInpText').val('');
				zlInfoMethod.getEwYqList(value);
				$('.uploadInpHid').removeClass('fmPathInp xxPathInp');
				if($('.zlTypeTxt').length > 0){//先选择了附件上传
					var zlTypeTxt = globalUpload.switchZlTypeCHN(value);
					$('.zlTypeTxt').each(function(i){
						$('.zlTypeTxt').eq(i).html(zlTypeTxt);
						form.render();
					});
				}
			});
			var page = {
				init : function(){
					this.onLoad();
				},
				onLoad : function(){
					if(addEditZlOpts == 'editZlOpts'){//表示编辑
						var _this = this;
						layer.load('1');
						$.ajax({
		   					type:'post',
		   			        dataType:'json',
		   			        data:{zlId : parent.globalZlId,opt:'basic'},
		   			        url:'/zlm.do?action=getZlDetail',
		   			        success:function (json){
		   			        	layer.closeAll('loading');
		   			        	if(json['result'] == 'success'){
		   			        		zlId = json.ajId;
		   			        		_this.renderZlBasicInfo(json);
		   			        		_this.bindEvent();
		   			        		$('#titSpan').html('编辑专利[<em style="color:#F47837;font-style:normal;">'+ json.ajTitle +'</em>]');
		   			        	}else if(json['result'] == 'error'){
		   			        		layer.msg('系统错误，请稍后重试', {icon:5,anim:6,time:1000});
		   			        	}else if(json['result'] == 'noAbility'){
		   			        		layer.msg('系统错误，请稍后重试', {icon:5,anim:6,time:1000});
		   			        	}else if(json['result'] == 'noInfo'){
		   			        		layer.msg('暂无此专利信息', {icon:5,anim:6,time:1000});
		   			        	}
		   			        }
		   				});
					}else{//表示增加 onload直接调用上传这个方法
						this.bindEvent();
						$('#titSpan').html('增加新专利');
						zlInfoMethod.selectFileUpload();
						zlInfoMethod.getCpyDate();
					}
				},
				bindEvent : function(){
					var _this = this;
					//关闭整个弹层
					$('.closeBtns').on('click',function(){
						var index= parent.layer.getFrameIndex(window.name);
        				parent.layer.close(index);
					});
					zlInfoMethod.bindEvent_comMet();
					//保存增加的专利
					$('#saveZlBtn').on('click',function(){
						var sqrName='',tmpFmPath=[],tmpXxPath=[], ajTitleVal = $.trim($('#ajTitleInp').val()),//案件标题
							//ajNumInpVal = $('#ajNumInp').val(),//案件编号
							zlTypeInpVal = $('#zlTypeInp').val(),//专利类型
							zlAgentFeeInpVal = $('#zlAgentFeeInp').val(),//发明、外观、实用新型对应专利代理费
							xxAgentFeeInpVal = $('#xxAgentFeeInp').val(),//新型对应的专利代理费
							ajFieldIdVal = $('#ajFieldId').val(),//案件技术领域
							ajSqAddressVal = $('#ajSqAddress').val(),//案件申请地区
							ajSqrIdVal = $('#ajSqrId').val(),//案件申请人
							ajLxrIdVal = $('#ajLxrId').val(),//案件联系人
							ajFmrIdVal = $('#ajFmrId').val(),//案件发明人
							jsLxrIdInpVal = $('#jsLxrIdInp').val(),//技术联系人
							yxqDetailInpVal = $('#yxqDetailInp').val(),//案件优先权
							//fujianInpVal = $('#fujianInp').val(),//案件附件
							ajEwyqIdVal = $('#ajEwyqId').val(),//案件额外要求
							ajRemarkVal = $('#ajRemark').val(),//案件备注
							cpyDateInpVal = $('#cpyDateInp').val(),//定稿提交截至时间
							pubZlIdInpVal = $('#pubZlIdInp').val(),//已领取专利任务
							url = '',fmPathVal = '',xxPathVal = '';
						ajFieldIdVal = zlInfoMethod.getIdStr('delFieldBtn','jffieldattrid');
						ajSqrIdVal = zlInfoMethod.getIdStr('delSqrBtn','sqrattrid');
						sqrName = zlInfoMethod.getIdStr('delSqrBtn','sqrattrname');
						ajLxrIdVal = zlInfoMethod.getIdStr('delLxrBtn','lxridattr');
						ajFmrIdVal = zlInfoMethod.getIdStr('delFmrBtn','fmridattr');
						ajJsLxrIdVal = zlInfoMethod.getIdStr('delJsLxrBtn','fmridattr');
						//alert(ajFieldIdVal + "----" + ajSqrIdVal + "--" + ajLxrIdVal + "--" + ajFmrIdVal + "----@@" + ajJsLxrIdVal)
						if(tmpEwyqIdArray.length != 0){
							$('#tmpAjEwyqId').val(tmpEwyqIdArray.join(','));
							ajEwyqIdVal = $('#tmpAjEwyqId').val();
						}else{
							$('#tmpAjEwyqId').val(0);
						}
						if(ajTitleVal == ''){
							layer.msg('案件标题不能为空', {icon:5,anim:6,time:1000});
						}else if(zlTypeInpVal == ''){
							layer.msg('请选择专利类型', {icon:5,anim:6,time:1000});
						}else if(zlAgentFeeInpVal == ''){
							layer.msg('专利代理费用不能为空', {icon:5,anim:6,time:1000});
						}else if(xxAgentFeeInpVal == '' && zlInfoMethod.data.isXxFeeFlag){
							layer.msg('新型专利代理费用不能为空', {icon:5,anim:6,time:1000});
						}else if(ajFieldIdVal == ''){
							layer.msg('请选择案件所属技术领域', {icon:5,anim:6,time:1000});
						}else if(ajSqAddressVal == ''){
							layer.msg('请选择案件申请地区', {icon:5,anim:6,time:1000});
						}else if(ajSqrIdVal == ''){
							layer.msg('请添加申请人', {icon:5,anim:6,time:1000});
						}else if(ajJsLxrIdVal == ''){
							layer.msg('请添加技术联系人', {icon:5,anim:6,time:1000});
						}else if(cpyDateInpVal == ''){
							layer.msg('定稿提交截止时间不能为空', {icon:5,anim:6,time:1000});
						}else{
							if($('.innerYxqBox').length > 0){
								var strResult = zlInfoMethod.getYxqId();
								if(strResult != undefined){
									yxqDetailInpVal = strResult;
								}else{
									//表明现在还有已经增加好但是没有填写完整的表单
									return;
								}
							}else{
								yxqDetailInpVal = '';
							}
							$('#tmpAjEwyqId').val() == '' ? ajEwyqIdVal = 0 : ajEwyqIdVal = $('#tmpAjEwyqId').val();
							var isHasUpLoadFlag = false,isFmxxFlag=false;
							if($('.deleteBtn').length > 0){
								if($('input[name="hasUpSuccInp"]').length == 0){//表示用户选择了文件，但是没有点击上传
									isHasUpLoadFlag = false;
								}else if($('input[name="hasUpSuccInp"]').length > 0 && $('input[name="notUpInp"]').length == 0){
									//表示用户选择了文件并且全部上传了
									isHasUpLoadFlag = true;
								}else if($('input[name="hasUpSuccInp"]').length > 0 && $('input[name="notUpInp"]').length > 0 && errorTypeFlag == false){
									//表示用户选择了文件并且上传了，然后用户又选择了文件但是并没有上传(格式都是正确的时候)
									isHasUpLoadFlag = false;
								}else if($('input[name="hasUpSuccInp"]').length > 0 && $('input[name="notUpInp"]').length > 0 && errorTypeFlag == true){
									//表示用户选择了文件并且上传了，然后用户又选择了文件但是并没有上传(格式有部分不正确，用户如果没有点击删除不正确按钮，点击保存直接保存)
									isHasUpLoadFlag = true;
								}
								if(isHasUpLoadFlag){//发明 外观 实用新型 采用ajUpload
									if(zlTypeInpVal != 'fmxx'){
										upSuccSrcArray.length = 0;
										$('input[name="hasUpSuccInp"]').each(function(i){
											upSuccSrcArray.push($('input[name="hasUpSuccInp"]').eq(i).val());
										});
										$('#fujianInp').val(upSuccSrcArray.join(','));
									}
								}else{
									layer.msg('您有未上传的附件，请先上传附件',{icon:5,anim:6,time:1000});
									return;
								}
								if(zlTypeInpVal == 'fmxx' && $('.zlTypeInpTarg').length > 0){
									$('.zlTypeInpTarg').each(function(i){
										if($('.zlTypeInpTarg').eq(i).val() != ''){
											isFmxxFlag = true;//所有当前专利类型是发明+新型的上传成功的附件都已经指派了类型
										}else{
											isFmxxFlag = false;
										}
									});
									if(isFmxxFlag && isHasUpLoadFlag){//所有是发明+新型选择的附件都已经上传成功
										tmpFmPath.length = 0;
										tmpXxPath.length = 0;
										$('.fmPathInp').each(function(i){
											tmpFmPath.push($('.fmPathInp').eq(i).val());
										});
										fmPathVal = tmpFmPath.join(',');
										$('.xxPathInp').each(function(i){
											tmpXxPath.push($('.xxPathInp').eq(i).val());
										});
										xxPathVal = tmpXxPath.join(',');
									}else{
										layer.msg('请给您上传的附件指派一个专利类型',{icon:5,anim:6,time:1500});
										return;
									}
								}
							}
							if($('#fmrBox p').length > 0 && $('#firstFmrId').length == 0){
								layer.msg('请给当前已选择发明人指定一个第一发明人',{icon:5,anim:6,time:2000});
								return;
							}
							if(addEditZlOpts == 'editZlOpts'){
								url = '/zlm.do?action=updateZlBasicInfo&zlId=' + zlId;
							}else{
								//表示增加专利
								var url = '/zlm.do?action=addZlData';	
			   				}
			   				if(zlTypeInpVal != 'fmxx'){
			   					//console.log("正常：："+ajTitleVal + "--" +zlTypeInpVal + "---" +  zlAgentFeeInpVal + "-" + ajFieldIdVal + "-" + ajSqAddressVal + "--" + ajSqrIdVal + "-" + ajLxrIdVal+"-"+ajFmrIdVal+"-"+yxqDetailInpVal+"-"+ajEwyqIdVal+"-"+ajRemarkVal+"-"+$('#fujianInp').val()+"-"+cpyDateInpVal+"-pubZlId=="+pubZlIdInpVal + "-----sqrNmme----" + sqrName)
			   					var field = {ajTitle:escape(ajTitleVal),
										ajType:zlTypeInpVal,dlFee:zlAgentFeeInpVal,ajFieldId:ajFieldIdVal,ajSqAddress:escape(ajSqAddressVal),
										ajSqrId:ajSqrIdVal,ajSqrName:escape(sqrName),ajLxrId:ajLxrIdVal,ajFmrId:ajFmrIdVal,jsLxrId:ajJsLxrIdVal,
										yxqDetail:yxqDetailInpVal,ajEwyqId:ajEwyqIdVal,ajRemark:escape(ajRemarkVal),
										ajUpload:$('#fujianInp').val(),cpyDate:cpyDateInpVal,pubZlId:pubZlIdInpVal};
			   				}else{
			   					$('#fujianInp').val('');
			   					//console.log("特殊：："+ajTitleVal + "--" +zlTypeInpVal + "---" +  zlAgentFeeInpVal + "-" + xxAgentFeeInpVal + "--" +  + ajFieldIdVal + "-" + ajSqAddressVal + "--" + ajSqrIdVal + "-" + ajLxrIdVal+"-"+ajFmrIdVal+"-"+yxqDetailInpVal+"-"+ajEwyqIdVal+"-"+ajRemarkVal+"-原来附件："+$('#fujianInp').val()+"---当前附件发明：" + fmPathVal + "--当前附件新型：" + xxPathVal + "----" +cpyDateInpVal+"-pubZlId=="+pubZlIdInpVal + "-----sqrNmme----" + sqrName)
			   					var field = {ajTitle:escape(ajTitleVal),
										ajType:zlTypeInpVal,dlFee_fm:zlAgentFeeInpVal,dlFee_xx:xxAgentFeeInpVal,ajFieldId:ajFieldIdVal,ajSqAddress:escape(ajSqAddressVal),
										ajSqrId:ajSqrIdVal,ajSqrName:escape(sqrName),ajLxrId:ajLxrIdVal,ajFmrId:ajFmrIdVal,jsLxrId:ajJsLxrIdVal,
										yxqDetail:yxqDetailInpVal,ajEwyqId:ajEwyqIdVal,ajRemark:escape(ajRemarkVal),
										fmPath:fmPathVal,xxPath:xxPathVal,cpyDate:cpyDateInpVal,pubZlId:pubZlIdInpVal};
			   				}
			   				layer.load('1');
							$.ajax({
			   					type:'post',
			   			        async:false,
			   			        dataType:'json',
			   			        data:field,
			   			        url:url,
			   			        success:function (json){
			   			        	layer.closeAll('loading');
			   			        	//console.log(json)
			   			        	if(json['result'] == 'success'){
			   			        		function callBackSucc(){
			   			        			var index= parent.layer.getFrameIndex(window.name);
					        				parent.addZlFlag = true;
					        				parent.layer.close(index);
			   			        		}
			   			        		if(addEditZlOpts == 'editZlOpts'){
			   			        			layer.msg('编辑专利成功',{icon:1,time:1000},callBackSucc);
			   			        		}else{
			   			        			layer.msg('添加专利成功',{icon:1,time:1000},callBackSucc);
			   			        		}
			   			        	}else if(json['result'] == 'noAbility'){
			   			        		layer.msg('抱歉，您暂无权限添加编辑专利', {icon:5,anim:6,time:1000});
			   			        	}else if(json['result'] == 'error'){
			   			        		layer.msg('系统错误，请稍后重试', {icon:5,anim:6,time:1000});
			   			        	}else if(json['result'] == 'typeDiff'){
			   			        		layer.msg('选择的专利类型和专利任务类型不一致', {icon:5,anim:6,time:2200});
			   			        	}else if(json['result'] == 'notUpdate'){
			   			        		layer.msg('定稿以后或专利状态终止条件下不能修改', {icon:5,anim:6,time:2200});
			   			        	}else if(json['result'] == 'addError'){
			   			        		layer.msg('当前选择的专利任务已被其他专利占用！', {icon:5,anim:6,time:2200});
			   			        	}
			   			        }
			   				});
						}
					});
				},
				//编辑时渲染结构
				renderZlBasicInfo : function(json){
					//console.log(json)
					var strHtml = '',isReadFlag = true;
					//案件标题
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"><span class="mustItem">*</span>案件标题</label><div class="layui-input-block">';
					strHtml += '<input id="ajTitleInp" type="text" name="ajTitle" placeholder="请输入案件标题(40字以内)" maxlength="40" value="'+ json.ajTitle +'" autocomplete="off" class="layui-input"/></div></div>';
					//案件编号 && 案件申请号/专利号
					strHtml += '<div class="layui-form-item clearfix"><div class="itemDiv"><label class="layui-form-label">案件编号</label><div class="layui-input-inline">';
					strHtml += '<input id="ajNumInp" type="text" disabled autocomplete="off" value="'+ json.ajNo +'" class="layui-input"/></div></div>';
					strHtml += '<div class="itemDiv"><label class="layui-form-label">案件申请号/专利号</label><div class="layui-input-inline">';
					strHtml += '<input id="ajSqZlNum" type="text" name="ajSqZlNum" disabled autocomplete="off" value="'+ json.ajNoGf +'" class="layui-input"/></div></div></div>';
					//专利类型 && 已领取专利任务
					strHtml += '<div class="layui-form-item clearfix">';
					strHtml += '<div class="itemDiv"><label class="layui-form-label"><span class="mustItem">*</span>专利类型</label><input id="zlTypeInp" name="ajType" type="hidden" value="'+ json.ajType +'"/><div class="layui-input-inline">';
					if(json.ajType == 'fm'){
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="fm" title="发明" checked/>';
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="syxx" title="实用新型"/>';
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="wg" title="外观"/>';
					}else if(json.ajType == 'syxx'){
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="fm" title="发明"/>';
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="syxx" title="实用新型" checked/>';
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="wg" title="外观"/>';
					}else if(json.ajType == 'wg'){
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="fm" title="发明"/>';
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="syxx" title="实用新型"/>';
						strHtml += '<input type="radio" name="zlTypeRad" class="zlTypeRad" lay-filter="zlTypeFilter" value="wg" title="外观" checked/>';
					}
					strHtml += '</div></div>';
					//已领取专利任务
					strHtml += '<div class="itemDiv"><label class="layui-form-label">已领取专利任务</label><div class="layui-input-inline">';
					strHtml += '<input id="pubZlIdInp" type="hidden" value="'+ json.pubZlId +'" name="pubZlId"/>';
					strHtml += '<input id="pubZlIdInpTxt" type="text" disabled autocomplete="off" value="'+ json.pubZlName +'" class="layui-input" style="width:94%"/>';
					strHtml += '<span class="selZlTaskSp" title="选择"><i class="layui-icon layui-icon-more"></i></span>';
					strHtml += '<span class="resetSp" title="重置"><i class="layui-icon layui-icon-delete"></i></span></div></div>';
					strHtml += '</div>';
					//专利难易度 专利代理费用
					strHtml += '<div class="layui-form-item">';
					strHtml += '<div class="itemDiv"><div class="diffDiv oneWid fl">';
					strHtml += '<label class="layui-form-label"><i class="diffTit">专利难易程度</i></label>';
					strHtml += '<div class="layui-input-inline"><div id="diffLevelOne"></div></div></div></div>';
					strHtml += '<div class="itemDiv agentFeeDiv"><div class="comAgentDiv oneAgentDiv oneWid fl">';
					strHtml += '<label class="layui-form-label"><span>*</span><i class="agentTit">专利代理费</i></label>';
					strHtml += '<div class="layui-input-inline"><em class="moneyDec" style="display:block;">¥</em><input id="zlAgentFeeInp" type="text" value="'+ json.dlFee +'" style="display:block;" placeholder="请输入代理费" autocomplete="off" class="layui-input agentInp"/></div></div></div>';
					strHtml += '</div>';
					//案件技术领域
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"><span class="mustItem">*</span>案件技术领域</label><div class="layui-input-block fixHeiDiv clearfix">';
					strHtml += '<div id="fieldBox" class="multiBox fl">';
					//var strJsId = '';
					for(var i=0;i<json.jsFieldInfo.length;i++){
						if(json.jsFieldInfo[i].checked){
							strHtml += '<p id="fieldId_'+ json.jsFieldInfo[i].jsId +'" jffieldattrid="'+ json.jsFieldInfo[i].jsId +'" class="delFieldBtn"><span>'+ json.jsFieldInfo[i].jsName +'</span><i class="layui-icon layui-icon-close"></i></p>';	
							fieldArray.push('fieldId_'+json.jsFieldInfo[i].jsId);
						}
					}
					strHtml += '<input id="ajFieldId" type="hidden" name="ajFieldId"/></div>';
					strHtml += '<span id="addFieldBtn" class="addSpan fl">添加技术领域</span></div></div>';
					//案件申请地区
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"><span class="mustItem">*</span>案件申请地区</label>';
					strHtml += '<input id="ajSqAddress" type="hidden" name="ajSqAddress" value="'+ json.ajAddress +'"/><div class="layui-input-block fixHeiDiv clearfix">';
					if(json.ajAddress == '中国'){
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国" title="中国[CN]" checked/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国香港" title="中国香港[HK]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国台湾" title="中国台湾[TW]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="澳门" title="澳门[MO]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="日本" title="日本[JP]"/>';
					}else if(json.ajAddress == '中国香港'){
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国" title="中国[CN]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国香港" title="中国香港[HK]" checked/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国台湾" title="中国台湾[TW]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="澳门" title="澳门[MO]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="日本" title="日本[JP]"/>';
					}else if(json.ajAddress == '中国台湾'){
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国" title="中国[CN]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国香港" title="中国香港[HK]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国台湾" title="中国台湾[TW]" checked/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="澳门" title="澳门[MO]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="日本" title="日本[JP]"/>';
					}else if(json.ajAddress == '澳门'){
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国" title="中国[CN]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国香港" title="中国香港[HK]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国台湾" title="中国台湾[TW]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="澳门" title="澳门[MO]" checked/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="日本" title="日本[JP]"/>';
					}else{
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国" title="中国[CN]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国香港" title="中国香港[HK]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="中国台湾" title="中国台湾[TW]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="澳门" title="澳门[MO]"/>';
						strHtml += '<input type="radio" name="ajSqRad" lay-filter="ajSqAreaFilter" value="日本" title="日本[JP]" checked/>';
					}
					strHtml += '</div></div>';
					//申请人
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"><span class="mustItem">*</span>申请人</label><input id="sqrIdInp" type="hidden"/>';
					strHtml += '<div class="layui-input-block fixHeiDiv clearfix"><input id="ajSqrId" type="hidden" value="'+ json.sqrId +'" name="ajSqrId"/>'; 
					strHtml += '<div id="sqrBox" class="multiBox fl">';
					var tmpArraySqrId = json.sqrId.split(',');
					var tmpArraySqrName = json.sqrName.split(',');
					sqrIdArray = tmpArraySqrId;
					sqrTxtArray = tmpArraySqrName;
					for(var i=0;i<tmpArraySqrName.length;i++){
						strHtml += '<p id="sqrId_'+ tmpArraySqrId[i] +'" sqrattrname="'+ tmpArraySqrName[i] +'" sqrattrid="'+ tmpArraySqrId[i] +'" class="delSqrBtn"><span>'+ tmpArraySqrName[i] +'</span><i class="layui-icon layui-icon-close"></i></p>';
						sqrArray.push('sqrId_'+tmpArraySqrId[i]);
						//sqrIdArray.push(tmpArraySqrId[i]);
						//sqrTxtArray.push(tmpArraySqrName[i]);
					}
					strHtml += '</div><span id="addSqrBtn" class="addSpan fl">添加/编辑申请人</span>';
					strHtml += '</div></div>';
					//联系人
					strHtml += '<div class="layui-form-item"><label class="layui-form-label">联系人</label><div class="layui-input-block fixHeiDiv clearfix">';
					strHtml += '<input id="ajLxrId" type="hidden" value="'+ json.lxrId +'" name="ajLxrId"/><div class="multiBox fl" style="width:100%;">';
					strHtml += '<div id="lxrBox" class="multiBox fl">';
					if(json.lxrId != ''){
						var tmpArrayLxrId = json.lxrId.split(',');
						var tmpArrayLxrName = json.lxrName.split(',');
						var tmpArraySqrLxrId = json.sqrLxrId.split(',');
						lxrIdNum = tmpArrayLxrId;
						for(var i=0;i<tmpArrayLxrName.length;i++){
							strHtml += '<p id="lxrId_'+ tmpArrayLxrId[i] +'" lxridattr="'+ tmpArrayLxrId[i] +'" sqrids="'+ tmpArraySqrLxrId[i] +'" class="lxFmTag delLxrBtn"><input type="hidden" class="lxrFmrInpHid" name="myParSqr_'+ tmpArraySqrLxrId[i] +'"><span>'+ tmpArrayLxrName[i] +'</span><i class="layui-icon layui-icon-close"></i></p>';
						}
					}
					strHtml += '</div><span id="addlxrBtn" opts="addLxrOpts" class="addSpan fl">添加/编辑联系人</span></div>';
					strHtml += '</div></div>';		
					//发明人
					strHtml += '<div class="layui-form-item"><label class="layui-form-label">发明人</label><div class="layui-input-block fixHeiDiv clearfix">';
					strHtml += '<input id="ajFmrId" type="hidden" name="ajFmrId" value="'+ json.fmrId +'"/><div class="multiBox fl" style="width:100%;">';
					strHtml += '<div id="fmrBox" class="multiBox fl">';	
					if(json.fmrId != ''){
						var tmpArrayFmrId = json.fmrId.split(',');
						var tmpArrayFmrName = json.fmrName.split(',');
						var tmpArraySqrFmrId = json.sqrFmrId.split(',');
						fmrIdNum = tmpArrayFmrId;
						for(var i=0;i<tmpArrayFmrName.length;i++){
							strHtml += '<p id="fmrId_'+ tmpArrayFmrId[i] +'" fmridattr="'+ tmpArrayFmrId[i] +'" sqrids="'+ tmpArraySqrFmrId[i] +'" class="lxFmTag delFmrBtn"><input type="hidden" class="lxrFmrInpHid" name="myParSqr_'+ tmpArraySqrFmrId[i] +'">';
							if(i == 0){//指定第一发明人
								strHtml += '<span><em class="firstNoteTxt fmrNoteTxt">[第一发明人]</em>'+ tmpArrayFmrName[i] +'</span><i class="layui-icon layui-icon-close"></i></p>';
							}else{
								strHtml += '<span>'+ tmpArrayFmrName[i] +'</span><i class="layui-icon layui-icon-close"></i></p>';
							}
						}	
					}
					strHtml += '</div><span id="addFmrBtn" opts="addFmrOpts" class="addSpan fl">添加/编辑发明人</span></div>';
					strHtml += '</div></div>';
					//技术联系人
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"><span class="mustItem">*</span>技术联系人</label><div class="layui-input-block fixHeiDiv clearfix">';
					strHtml += '<input id="jsLxrIdInp" type="hidden" value="'+ json.jsLxrId +'" name="jsLxrIdInp"/><div class="multiBox fl" style="width:100%;">';
					strHtml += '<div id="techLxrBox" class="multiBox fl">';
					if(json.jsLxrId != ''){
						var tmpArrayJsLxrId = json.jsLxrId.split(',');
						var tmpArrayJsLxrName = json.jsLxrName.split(',');
						var tmpArraySqrJsLxrId = json.sqrJsrId.split(',');
						jsLxrIdNum = tmpArrayJsLxrId;
						for(var i=0;i<tmpArrayJsLxrName.length;i++){
							strHtml += '<p id="fmrId_'+ tmpArrayJsLxrId[i] +'" fmridattr="'+ tmpArrayJsLxrId[i] +'" sqrids="'+ tmpArraySqrJsLxrId[i] +'" class="lxFmTag delJsLxrBtn"><input type="hidden" class="lxrFmrInpHid" name="myParSqr_'+ tmpArraySqrJsLxrId[i] +'"><span>'+ tmpArrayJsLxrName[i] +'</span><i class="layui-icon layui-icon-close"></i></p>';
						}
					}
					strHtml += '</div><span id="addJsLxrBtn" opts="addJsLxrOpts" class="addSpan fl">添加/编辑技术联系人</span></div>';
					strHtml += '</div></div>';
					//案件优先权
					strHtml += '<div class="layui-form-item"><label class="layui-form-label">优先权</label><div class="blockDiv fixHeiDiv clearfix">';
					strHtml += '<input id="yxqDetailInp" type="hidden" name="yxqDetail"/><div id="yxqBox"><div id="innerYxqBox">';
					if(json.ajYxqDetail != ''){
						var tmpYxqZlNum = json.ajYxqDetail.split(':')[0].split(',');
						var tmpYxqSqArea = json.ajYxqDetail.split(':')[1].split(',');
						var tmpYxqDate = json.ajYxqDetail.split(':')[2].split(',');
						num = tmpYxqZlNum.length;
						for(var i=0;i<tmpYxqZlNum.length;i++){
							strHtml += '<div class="innerYxqBox">';
							strHtml += '<input placeholder="请输入案件申请号/专利号" type="text" value="'+ tmpYxqZlNum[i] +'" autocomplete="off" class="layui-input zlAjNumInp"/>';
							strHtml += '<div class="innerSelAddBox"><select class="zlYxqAreaInp" lay-filter="selAreaFilter">';
							strHtml += '<option value="">请选择</option>';
							if(tmpYxqSqArea[i] == '中国'){
								strHtml += '<option value="中国" selected>中国[CN]</option>';
								strHtml += '<option value="中国香港">中国香港[HK]</option>';
								strHtml += '<option value="中国台湾">中国台湾[TW]</option>';
								strHtml += '<option value="澳门">澳门[MO]</option>';
								strHtml += '<option value="日本">日本[JP]</option>';
							}else if(tmpYxqSqArea[i] == '中国香港'){
								strHtml += '<option value="中国">中国[CN]</option>';
								strHtml += '<option value="中国香港" selected>中国香港[HK]</option>';
								strHtml += '<option value="中国台湾">中国台湾[TW]</option>';
								strHtml += '<option value="澳门">澳门[MO]</option>';
								strHtml += '<option value="日本">日本[JP]</option>';
							}else if(tmpYxqSqArea[i] == '中国台湾'){
								strHtml += '<option value="中国">中国[CN]</option>';
								strHtml += '<option value="中国香港">中国香港[HK]</option>';
								strHtml += '<option value="中国台湾" selected>中国台湾[TW]</option>';
								strHtml += '<option value="澳门">澳门[MO]</option>';
								strHtml += '<option value="日本">日本[JP]</option>';
							}else if(tmpYxqSqArea[i] == '澳门'){
								strHtml += '<option value="中国">中国[CN]</option>';
								strHtml += '<option value="中国香港">中国香港[HK]</option>';
								strHtml += '<option value="中国台湾">中国台湾[TW]</option>';
								strHtml += '<option value="澳门" selected>澳门[MO]</option>';
								strHtml += '<option value="日本">日本[JP]</option>';
							}else if(tmpYxqSqArea[i] == '日本'){
								strHtml += '<option value="中国">中国[CN]</option>';
								strHtml += '<option value="中国香港">中国香港[HK]</option>';
								strHtml += '<option value="中国台湾">中国台湾[TW]</option>';
								strHtml += '<option value="澳门">澳门[MO]</option>';
								strHtml += '<option value="日本" selected>日本[JP]</option>';
							}
							strHtml += '</select></div>';
							strHtml += '<input placeholder="请选择日期" type="text" name="" autocomplete="off" id="dateInp_'+ (i+1) +'" value="'+ tmpYxqDate[i] +'" class="layui-input yxqInpDate"/>';
							strHtml += '<i class="layui-icon layui-icon-delete delYxqIcon"  title="删除"></i>';
							strHtml += '</div>';
							laydate.render({
								elem:'#dateInp_' + (i+1)
							});
						}
					}
					strHtml += '</div><span id="addYxqBtn" class="addSpan margLAddSp fl">添加优先权</span></div>';
					strHtml += '</div></div>';
					//案件额外要求
					strHtml += '<div class="layui-form-item"><label class="layui-form-label">案件额外要求</label>';
					strHtml += '<input id="ajEwyqId" type="hidden" name="ajEwyqId"/><input id="tmpAjEwyqId" type="hidden"/>';
					strHtml += '<div id="ewyqBpx" class="layui-input-block">';
					if(json.yqInfo.length > 0){
						for(var i=0;i<json.yqInfo.length;i++){
							if(json.yqInfo[i].checked){
								strHtml += '<input type="checkbox" name="zlYqInfoInp" lay-filter="ewyqFilter" value="'+ json.yqInfo[i].yqId +'" title="'+ json.yqInfo[i].yaContent +'" lay-skin="primary" checked/>';
								tmpEwyqIdArray.push(json.yqInfo[i].yqId);
							}else{
								strHtml += '<input type="checkbox" name="zlYqInfoInp" lay-filter="ewyqFilter" value="'+ json.yqInfo[i].yqId +'" title="'+ json.yqInfo[i].yaContent +'" lay-skin="primary"/>';	
							}
						}
					}else{
						strHtml += '<p class="ewyqTips">无专利额外要求</p>';
					}
					strHtml += '</div></div>';
					//案件备注
					strHtml += '<div class="layui-form-item"><label class="layui-form-label">案件备注</label><div class="layui-input-block">';
					strHtml += '<textarea id="ajRemark" name="ajRemark" placeholder="请输入案件备注(80字以内)" class="layui-textarea" maxlength="80">'+ json.ajRemark +'</textarea>';
					strHtml += '</div></div>';
					//定稿提交截至时间
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"><span class="mustItem">*</span>定稿提交截止时间</label><div class="layui-input-inline">';
					strHtml += '<input type="text" class="layui-input" id="cpyDateInp" value="'+ json.cpyDate +'" name="cpyDate"/></div><div class="layui-form-mid layui-word-aux">(系统默认一个月)</div></div>';
					//案件附件
					strHtml += '<div class="layui-form-item"><label class="layui-form-label">案件附件</label><div class="layui-input-block">';
					strHtml += '<button type="button" class="layui-btn layui-btn-normal" id="selFileBtn">选择文件</button>';
					strHtml += '  <span class="noticeSpan">注：附件中单个图片大小不能超过5M，单个文件大小不能超过10M (非必填项)，最多可上传5个文件</span>';
					strHtml += '<button type="button" class="layui-btn" id="upListAction">上传附件</button></div></div>';
					
					strHtml += '<div class="layui-form-item"><input id="fujianInp" name="zlUpCl" type="hidden"/>';
					strHtml += '<div class="layui-input-block"><table class="layui-table"><thead>';
					strHtml += '<tr><th>附件名</th><th>专利类型</th><th>大小</th><th>状态</th><th>进度</th><th>操作</th></tr></thead>';
					strHtml += '<tbody id="upLoadFileList">';
					var zlUpClArray = json.upFile;
					var zlTypeTxt = globalUpload.switchZlTypeCHN(json.ajType);
					for(var i=0;i<zlUpClArray.length;i++){
						strHtml += '<tr id="upload-'+ i +'">';
						strHtml += '<td>'+ zlUpClArray[i].fileName +'</td>';
						strHtml += '<td><div class="zlTypeTxt layui-form">'+ zlTypeTxt +'</div></td>';
						strHtml += '<td>'+ zlUpClArray[i].fileSize +'</td>';
						strHtml += '<td><span style="color: #5FB878;">上传成功</span></td>';
						strHtml += '<td style="width:120px;"><div class="layui-progress layui-progress-big" lay-showpercent="true">';
						strHtml += '<div class="layui-progress-bar progressBarBg" lay-percent="100%" style="width:100%;"><span class="layui-progress-text">100%</span></div></div>';
						strHtml += '</td>';
						strHtml += '<td>';
						strHtml += '<input class="uploadInpHid" name="hasUpSuccInp" value="'+ zlUpClArray[i].upPath +'" type="hidden"/>';
						strHtml += '<button class="layui-btn layui-btn-xs layui-btn-danger deleteBtn deleteBtn_edit">删除</button>';
						strHtml += '<button class="layui-btn layui-btn-xs downloadBtn" downFilePath="'+ zlUpClArray[i].downFilePath +'">下载</button></td>';
						strHtml += '</tr>';
					}
					strHtml += '</tbody></table>';
					strHtml += '</div></div>';
					//保存按钮
					strHtml += '<div class="layui-form-item"><label class="layui-form-label"></label><div class="layui-input-block" style="width:75%;text-align:center;">';
					strHtml += '<button type="button" id="saveZlBtn" class="layui-btn" style="width:120px;margin-left:0px;">保存专利</button></div></div>';
					$('#addNewZl').html(strHtml);
					form.render();
					if(json.ajYxqDetail != ''){	
						zlInfoMethod.delYxq();
					}
					laydate.render({
						elem: '#cpyDateInp'
					});
					zlInfoMethod.selectFileUpload();//编辑时渲染结构完成调用上传方法
					delHasAddMethod('delFieldBtn','delFieldOpt');
					delHasAddMethod('delSqrBtn','delSqrOpt');
					if(json.lxrId != ''){
						delHasAddMethod('delLxrBtn','delLxrOpt');
					}
					if(json.fmrId != ''){
						delHasAddMethod('delFmrBtn','delFmrOpt');
					}
					delHasAddMethod('delJsLxrBtn','delJsLxrOpt');
					if(json.pubZlName != ''){//编辑首次进来页面判断是否存在已添加的专利任务存在激活重置
						parent.$('#lqZlIdInp').val(json.pubZlId);//将已经存在数据库的pubZlId赋给父级用于弹窗页面的回显
			  		}
					$('.downloadBtn').on('click',function(){
						var downFilePath = $(this).attr('downFilePath');
						common.downFiles(downFilePath,0);
					});
					common.rateFunReadOnly('diffLevelOne',json.zlLevel);
					zlInfoMethod.agentDlFee_usual();
					zlInfoMethod.agentFeeTxtByZlType(json.ajType);
				}
			};
			$(function(){
				page.init();				
			});
		});
	</script>
</body> 
</html>