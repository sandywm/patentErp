<!DOCTYPE html>
<html>
<head>
 	<meta charset="utf-8"/>
 	<link href="/plugins/layui/css/layui.css" rel="stylesheet" type="text/css"/>
 	<link href="/plugins/pace/pace-theme-flash.min.css" rel="stylesheet" type="text/css"/>
 	<link href="/Module/pubZlManager/css/pubZlManager.css" rel="stylesheet" type="text/css"/>
	<script src="/plugins/pace/pace.min.js" type="text/javascript"></script>
  	<title>增加新专利</title>
</head>
<body style="background:#fff;">
	<div id="viewZlTask" class="layui-form">
		<ul id="viewZlTaskUl"></ul>
		<!-- 撰写人领取撤销记录 -->
		<div id="receiveHisWrap"></div>
	</div>
	
	<script src="/plugins/layui/layui.js"></script>
	<script type="text/javascript">
		var pubId = parent.globalPubId;
		layui.use(['layer','jquery','form','upload'],function(){
			var layer = layui.layer,
				$ = layui.jquery,
				form = layui.form,
				upload = layui.upload;
			var page = {
				init : function(){
					this.onLoad();
					this.bindEvent();
				},
				onLoad : function(){
					var _this = this;
					layer.load('1');
					$.ajax({
	   					type:'post',
	   			        async:false,
	   			        dataType:'json',
	   			        data:{pubId : pubId},
	   			        url:'/pubZl.do?action=getDetailInfo',
	   			        success:function (json){
	   			        	console.log(json)
	   			        	layer.closeAll('loading');
	   			        	if(json['result'] == 'success'){
	   			        		_this.renderViewPubZlDetail(json);
	   			        	}else if(json['result'] == 'outDate'){
	   			        		layer.msg('抱歉，您当前的会员已经到期，暂不能查看', {icon:5,anim:6,time:1000});
	   			        	}
	   			        }
	   				});
				},
				bindEvent : function(){
					
				},
				//渲染任务详情结构
				renderViewPubZlDetail : function(json){
					console.log(json)
					var strHtml = '',receiveHisHtml='';
					strHtml += '<li class="taskTitDetail">'+ json.zlTitle +'</li>';
					strHtml += '<li><div class="innerPar"><p>发布者</p><p>'+ json.pubInfo +'</p></div>';
					strHtml += '<div class="innerPar"><p>发布日期</p><p>'+ json.pubDate +'</p></div></li>';
					strHtml += '<li><div class="innerPar"><p>专利类型</p><p>'+ json.typeChi +'</p></div>';
					strHtml += '<div class="innerPar"><p>领取状态</p><p>';
					if(json.zlStatus == 0){//待领取
						strHtml += '<span  class="waitReceiveSp">'+ json.zlStatusChi +'</span>';
						strHtml += '<button class="layui-btn layui-btn-xs receiveBtn">领取</button>';
					}else{
						strHtml += '<span class="hasReceiveSp">'+ json.zlStatusChi +'</span>';
						strHtml += '<button class="layui-btn layui-btn-xs layui-btn-danger resetReceiveBtn">撤销领取</button>';
					}
					strHtml += '</p></div></li>';
					strHtml += '<li><div class="innerPar"><p>案件编号</p><p>'+ json.ajNoQt +'</p></div>';
					strHtml += '<div class="innerPar"><p>联系人</p><p>'+ json.pubLxrInfo +'</p></div></li>';
					strHtml += '<li><div class="innerPar"><p>联系方式</p><p>'+ json.pubLxrTelInfo +'</p></div>';
					strHtml += '<div class="innerPar"><p>联系邮箱</p><p>'+ json.pubLxrEmailInfo +'</p></div></li>';
					strHtml += '<li class="specHeiLi clearfix"><div class="innerPar clearfix"><p>专利描述</p><p><span>'+ json.zlContent +'</span></p></div></li>';
					strHtml += '<li class="fujianLi clearfix"><div class="innerPar clearfix" style="width:100%;"><p>附件</p><p class="fujianWrap">';
					for(var i=0;i<json.zlUpCl.length;i++){
						strHtml += '<span><i class="layui-icon layui-icon-file"></i> '+ json.zlUpCl[i].fileName +' ('+ json.zlUpCl[i].fileSize +') <button class="layui-btn layui-btn-normal layui-btn-xs downLoadBtn" downFilePath="'+ json.zlUpCl[i].downFilePath +'">下载</button></span>';
					}
					strHtml += '</p></div></li>';
					strHtml += '<li><div class="innerPar"><p>领取人</p><p>'+ json.lqrName +'</p></div>';
					strHtml += '<div class="innerPar"><p>领取时间</p><p>'+ json.lqDate +'</p></div></li>';
					strHtml += '<li><div class="innerPar" style="width:100%;border-right:none;"><p>领取人所属公司</p><p>'+ json.lqrCpyName +'</p></div></li>';
					$('#viewZlTaskUl').html(strHtml);
					receiveHisHtml += '<fieldset class="layui-elem-field layui-field-title site-title">';
					receiveHisHtml += '<legend><a name="use">撰写人领取撤销记录</a></legend></fieldset>';
					$('#receiveHisWrap').html(receiveHisHtml);
				}
			};
			$(function(){
				page.init();
			});
		});
	</script>
</body> 
</html>